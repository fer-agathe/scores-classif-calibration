<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Random Forests – Probabilistic Scores of Classifiers: Calibration is not Enough</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./book_ojeda_forests_ntrees.html" rel="next">
<link href="./book_ojeda_trees.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.js"></script>
<link href="site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/dt-ext-rowgroup-1.13.6/css/rowGroup.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-rowgroup-1.13.6/js/dataTables.rowGroup.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { extensions: ["color.js"] }});
</script>
<script type="text/x-mathjax-config">
	MathJax.Hub.Register.StartupHook("TeX color Ready", function() {
	     MathJax.Extension["TeX/color"].colors["wongBlack"] = '#000000';
		 MathJax.Extension["TeX/color"].colors["wongGold"] = '#E69F00';
		 MathJax.Extension["TeX/color"].colors["wongLightBlue"] = '#56B4E9';
		 MathJax.Extension["TeX/color"].colors["wongGreen"] = '#009E73';
		 MathJax.Extension["TeX/color"].colors["wongYellow"] = '#F0E442';
		 MathJax.Extension["TeX/color"].colors["wongBlue"] = '#0072B2';
		 MathJax.Extension["TeX/color"].colors["wongOrange"] = '#D55E00';
		 MathJax.Extension["TeX/color"].colors["wongPurple"] = '#CC79A7';
		 
		 
		 MathJax.Extension["TeX/color"].colors["IBMBlue"] = '#648FFF';
		 MathJax.Extension["TeX/color"].colors["IBMPurple"] = '#785EF0';
		 MathJax.Extension["TeX/color"].colors["IBMMagenta"] = '#DC267F';
		 MathJax.Extension["TeX/color"].colors["IBMOrange"] = '#FE6100';
		 MathJax.Extension["TeX/color"].colors["IBMYellow"] = '#FFB000';
	});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Probabilistic Scores of Classifiers: Calibration is not Enough</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/fer-agathe/scores-classif-calibration"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./book_ojeda.html">Simulated Data</a></li><li class="breadcrumb-item"><a href="./book_ojeda_forests.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Random Forests</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Subsampling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_target_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Targeted Distribution</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Metrics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Metrics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Simulated Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simulated Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda_trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Decision Trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda_forests.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Random Forests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda_forests_ntrees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Random Forests: number of trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda_boosting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Extreme Gradient Boosting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda_glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda_gam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Generalized Additive Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda_gamsel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Generalized Additive Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_ojeda_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Comparison of Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Real-world Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_real_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Priors: Illustration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_real_beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Datasets and Priors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_real_estimations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Estimations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book_real_results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data" id="toc-data" class="nav-link active" data-scroll-target="#data"><span class="header-section-number">6.1</span> Data</a></li>
  <li><a href="#metrics" id="toc-metrics" class="nav-link" data-scroll-target="#metrics"><span class="header-section-number">6.2</span> Metrics</a></li>
  <li><a href="#simulations-setup" id="toc-simulations-setup" class="nav-link" data-scroll-target="#simulations-setup"><span class="header-section-number">6.3</span> Simulations Setup</a></li>
  <li><a href="#simulations" id="toc-simulations" class="nav-link" data-scroll-target="#simulations"><span class="header-section-number">6.4</span> Simulations</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">6.5</span> Results</a>
  <ul class="collapse">
  <li><a href="#tables" id="toc-tables" class="nav-link" data-scroll-target="#tables"><span class="header-section-number">6.5.1</span> Tables</a></li>
  <li><a href="#figures" id="toc-figures" class="nav-link" data-scroll-target="#figures"><span class="header-section-number">6.5.2</span> Figures</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./book_ojeda.html">Simulated Data</a></li><li class="breadcrumb-item"><a href="./book_ojeda_forests.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Random Forests</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-random-forests" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Random Forests</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This chapter investigates the distribution of scores returned by random forests. We consider here a fixed size for the forests and make the complexity of the trees of the forest vary (by varying the minimal number of observations per termina leaf). We also vary the number of variables considered to perform a split.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggh4x'

The following object is masked from 'package:ggplot2':

    guide_axis_logticks</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(locfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>locfit 1.5-9.9   2024-03-01

Attaching package: 'locfit'

The following object is masked from 'package:purrr':

    none</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(philentropy)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Colours for train/validation/test</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>colour_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Train"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Validation"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Test"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>definition of the <code>theme_paper()</code> function (for ggplot2 graphs)</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Theme for ggplot2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param ... arguments passed to the theme function</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @importFrom ggplot2 element_rect element_text element_blank element_line unit</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'   rel</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>theme_paper <span class="ot">&lt;-</span> <span class="cf">function</span> (...) {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_base</span>() <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">linetype=</span><span class="st">"solid"</span>, <span class="at">colour =</span><span class="st">"black"</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_blank</span>()</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="data" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="data"><span class="header-section-number">6.1</span> Data</h2>
<p>We generate data using the first 12 scenarios from <span class="citation" data-cites="Ojeda_2023">Ojeda et al. (<a href="references.html#ref-Ojeda_2023" role="doc-biblioref">2023</a>)</span> and an additional set of 4 scenarios in which the true probability does not depend on the predictors in a linear way (see <a href="book_ojeda.html" class="quarto-xref">Chapter&nbsp;<span>4</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"functions/data-ojeda.R"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ks)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"functions/subsample_target_distribution.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When we simulate a dataset, we draw the following number of observations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>nb_obs <span class="ot">&lt;-</span> <span class="dv">10000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Definition of the 16 scenarios</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients beta</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First category (baseline, 2 covariates)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),  <span class="co"># scenario 1, 0 noise variable</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),  <span class="co"># scenario 2, 10 noise variables</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),  <span class="co"># scenario 3, 50 noise variables</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),  <span class="co"># scenario 4, 100 noise variables</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Second category (same as baseline, with lower number of 1s)</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),  <span class="co"># scenario 5, 0 noise variable</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),  <span class="co"># scenario 6, 10 noise variables</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),  <span class="co"># scenario 7, 50 noise variables</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),  <span class="co"># scenario 8, 100 noise variables</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Third category (same as baseline but with 5 num. and 5 categ. covariates)</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>),</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fourth category (nonlinear predictor, 3 covariates)</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, .<span class="dv">3</span>),  <span class="co"># scenario 5, 0 noise variable</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, .<span class="dv">3</span>),  <span class="co"># scenario 6, 10 noise variables</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, .<span class="dv">3</span>),  <span class="co"># scenario 7, 50 noise variables</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, .<span class="dv">3</span>)  <span class="co"># scenario 8, 100 noise variables</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean parameter for the normal distribution to draw from to draw num covariates</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>mean_num <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First category (baseline, 2 covariates)</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># scenario 1, 0 noise variable</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># scenario 2, 10 noise variables</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># scenario 3, 50 noise variables</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># scenario 4, 100 noise variables</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Second category (same as baseline, with lower number of 1s)</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># scenario 5, 0 noise variable</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># scenario 6, 10 noise variables</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># scenario 7, 50 noise variables</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># scenario 8, 100 noise variables</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Third category (same as baseline but with 5 num. and 5 categ. covariates)</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fourth category (nonlinear predictor, 3 covariates)</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Sd parameter for the normal distribution to draw from to draw num covariates</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>sd_num <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First category (baseline, 2 covariates)</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="co"># scenario 1, 0 noise variable</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="co"># scenario 2, 10 noise variables</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="co"># scenario 3, 50 noise variables</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="co"># scenario 4, 100 noise variables</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Second category (same as baseline, with lower number of 1s)</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="co"># scenario 5, 0 noise variable</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="co"># scenario 6, 10 noise variables</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="co"># scenario 7, 50 noise variables</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="co"># scenario 8, 100 noise variables</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Third category (same as baseline but with 5 num. and 5 categ. covariates)</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fourth category (nonlinear predictor, 3 covariates)</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>params_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>,</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">coefficients =</span> coefficients,</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_num =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">4</span>)),</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">add_categ =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">FALSE</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="cn">TRUE</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">FALSE</span>, <span class="dv">4</span>)),</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_noise =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>), <span class="dv">4</span>),</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_num =</span> mean_num,</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd_num =</span> sd_num,</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">size_train =</span> <span class="fu">rep</span>(nb_obs, <span class="dv">16</span>),</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">size_valid =</span> <span class="fu">rep</span>(nb_obs, <span class="dv">16</span>),</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">size_test =</span> <span class="fu">rep</span>(nb_obs, <span class="dv">16</span>),</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform_probs =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">FALSE</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">TRUE</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">FALSE</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">FALSE</span>, <span class="dv">4</span>)),</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">linear_predictor =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">TRUE</span>, <span class="dv">12</span>), <span class="fu">rep</span>(<span class="cn">FALSE</span>, <span class="dv">4</span>)),</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">202105</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(coefficients, mean_num, sd_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="metrics" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="metrics"><span class="header-section-number">6.2</span> Metrics</h2>
<p>We load the functions from <a href="book_metrics.html" class="quarto-xref">Chapter&nbsp;<span>3</span></a> to compute performance, calibration and divergence metrics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"functions/metrics.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulations-setup" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="simulations-setup"><span class="header-section-number">6.3</span> Simulations Setup</h2>
<p>We train different forests using the {ranger} package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For each scenario, we train regression forests. Each forest is made of 250 trees (smaller forests are considered in <a href="book_ojeda_forests_ntrees.html" class="quarto-xref">Chapter&nbsp;<span>7</span></a>). We consider here the following hyperparameters:</p>
<ul>
<li><code>mtry</code>: Number of variables to possibly split at in each node: 2, 4 or 10.</li>
<li><code>min_node_size</code>: Minimal node size to split at. Varying values between 2 and 10^{4}.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>min_bucket_values <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">round</span>(<span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">14</span>, <span class="at">by =</span> .<span class="dv">4</span>)))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>min_bucket_values <span class="ot">&lt;-</span> min_bucket_values[min_bucket_values <span class="sc">&lt;=</span>  <span class="fu">max</span>(params_df<span class="sc">$</span>size_train)]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_trees =</span> <span class="dv">250</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_node_size =</span> min_bucket_values</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ind =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The desired number of replications for each scenario needs to be set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>repns_vector <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The different configurations are reported in <a href="book_ojeda_forests_ntrees.html#tbl-grid-values-rf" class="quarto-xref">Table&nbsp;<span>7.1</span></a>.</p>
<div class="cell">
<div id="tbl-grid-values-rf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-grid-values-rf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.1: Grid Search Values
</figcaption>
<div aria-describedby="tbl-grid-values-rf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c7ed751e2409cd37ac06" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c7ed751e2409cd37ac06">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90"],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],[250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250],[2,3,5,6,8,11,14,18,24,32,42,56,74,97,128,169,223,294,388,512,676,891,1176,1552,2048,2702,3566,4705,6208,8192,2,3,5,6,8,11,14,18,24,32,42,56,74,97,128,169,223,294,388,512,676,891,1176,1552,2048,2702,3566,4705,6208,8192,2,3,5,6,8,11,14,18,24,32,42,56,74,97,128,169,223,294,388,512,676,891,1176,1552,2048,2702,3566,4705,6208,8192]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mtry<\/th>\n      <th>num_trees<\/th>\n      <th>min_node_size<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mtry","targets":1},{"name":"num_trees","targets":2},{"name":"min_node_size","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
<p>We define a function, <code class="sourceCode r"><span class="fu">simul_forest</span>()</code> to train a random forest on a dataset for a type of forest, with given hyperparameters (given to the function through the <code>param</code> argument).</p>
<div class="cell">
<details class="code-fold">
<summary>Function <code class="sourceCode r"><span class="fu">simul_forest</span>()</code></summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Train a random forest and compute performance, calibration, and dispersion </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' metrics</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param params tibble with hyperparameters for the simulation</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param ind index of the grid (numerical ID)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param simu_data simulated data obtained with `simulate_data_wrapper()`</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#'  for probability trees</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>simul_forest <span class="ot">&lt;-</span> <span class="cf">function</span>(params,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                         ind,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                         simu_data) {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  tb_train <span class="ot">&lt;-</span> simu_data<span class="sc">$</span>data<span class="sc">$</span>train <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">d =</span> y)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  tb_valid <span class="ot">&lt;-</span> simu_data<span class="sc">$</span>data<span class="sc">$</span>valid <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">d =</span> y)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  tb_test <span class="ot">&lt;-</span> simu_data<span class="sc">$</span>data<span class="sc">$</span>test <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">d =</span> y)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  true_prob <span class="ot">&lt;-</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">train =</span> simu_data<span class="sc">$</span>data<span class="sc">$</span>probs_train,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">valid =</span> simu_data<span class="sc">$</span>data<span class="sc">$</span>probs_valid,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">test =</span> simu_data<span class="sc">$</span>data<span class="sc">$</span>probs_test</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimation----</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  fit_rf <span class="ot">&lt;-</span> <span class="fu">ranger</span>(</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    d <span class="sc">~</span> .,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tb_train,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.bucket =</span> params<span class="sc">$</span>min_node_size,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry =</span> params<span class="sc">$</span>mtry,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">num.trees =</span> params<span class="sc">$</span>num_trees</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Average number of leaves per trees in the forest</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  nb_leaves <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(fit_rf<span class="sc">$</span>forest<span class="sc">$</span>child.nodeIDs, <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">pluck</span>(.x, <span class="dv">1</span>) <span class="sc">==</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>()</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Raw Scores----</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predicted scores</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  scores_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_rf, <span class="at">data =</span> tb_train, <span class="at">type =</span> <span class="st">"response"</span>)<span class="sc">$</span>predictions</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  scores_valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_rf, <span class="at">data =</span> tb_valid, <span class="at">type =</span> <span class="st">"response"</span>)<span class="sc">$</span>predictions</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  scores_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_rf, <span class="at">data =</span> tb_test, <span class="at">type =</span> <span class="st">"response"</span>)<span class="sc">$</span>predictions</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Histogram of scores----</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">05</span>)</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>  scores_train_hist <span class="ot">&lt;-</span> <span class="fu">hist</span>(scores_train, <span class="at">breaks =</span> breaks, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>  scores_valid_hist <span class="ot">&lt;-</span> <span class="fu">hist</span>(scores_valid, <span class="at">breaks =</span> breaks, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>  scores_test_hist <span class="ot">&lt;-</span> <span class="fu">hist</span>(scores_test, <span class="at">breaks =</span> breaks, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  scores_hist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">train =</span> scores_train_hist,</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">valid =</span> scores_valid_hist,</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> scores_test_hist</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimation of P(q1 &lt; score &lt; q2)----</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>  proq_scores_train <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">4</span>),</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">prop_btw_quantiles</span>(<span class="at">s =</span> scores_train, <span class="at">q1 =</span> .x)</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"train"</span>)</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>  proq_scores_valid <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">4</span>),</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">prop_btw_quantiles</span>(<span class="at">s =</span> scores_valid, <span class="at">q1 =</span> .x)</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"valid"</span>)</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>  proq_scores_test <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">4</span>),</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">prop_btw_quantiles</span>(<span class="at">s =</span> scores_test, <span class="at">q1 =</span> .x)</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"test"</span>)</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Dispersion Metrics----</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>  disp_train <span class="ot">&lt;-</span> <span class="fu">dispersion_metrics</span>(</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">true_probas =</span> true_prob<span class="sc">$</span>train, <span class="at">scores =</span> scores_train</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"train"</span>)</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>  disp_valid <span class="ot">&lt;-</span> <span class="fu">dispersion_metrics</span>(</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">true_probas =</span> true_prob<span class="sc">$</span>valid, <span class="at">scores =</span> scores_valid</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"valid"</span>)</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>  disp_test <span class="ot">&lt;-</span> <span class="fu">dispersion_metrics</span>(</span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">true_probas =</span> true_prob<span class="sc">$</span>test, <span class="at">scores =</span> scores_test</span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"test"</span>)</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Performance and Calibration Metrics</span></span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We add very small noise to predicted scores</span></span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># otherwise the local regression may crash</span></span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>  scores_train_noise <span class="ot">&lt;-</span> scores_train <span class="sc">+</span></span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">length</span>(scores_train), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.01</span>)</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>  scores_train_noise[scores_train_noise <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>  metrics_train <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> tb_train<span class="sc">$</span>d, <span class="at">scores =</span> scores_train_noise, <span class="at">true_probas =</span> true_prob<span class="sc">$</span>train</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"train"</span>)</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>  scores_valid_noise <span class="ot">&lt;-</span> scores_valid <span class="sc">+</span></span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">length</span>(scores_valid), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.01</span>)</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>  scores_valid_noise[scores_valid_noise <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>  metrics_valid <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> tb_valid<span class="sc">$</span>d, <span class="at">scores =</span> scores_valid_noise, <span class="at">true_probas =</span> true_prob<span class="sc">$</span>valid</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"valid"</span>)</span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a>  scores_test_noise <span class="ot">&lt;-</span> scores_test <span class="sc">+</span></span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">length</span>(scores_test), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.01</span>)</span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a>  scores_test_noise[scores_test_noise <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a>  metrics_test <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> tb_test<span class="sc">$</span>d, <span class="at">scores =</span> scores_test_noise, <span class="at">true_probas =</span> true_prob<span class="sc">$</span>test</span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"test"</span>)</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a>  tb_metrics <span class="ot">&lt;-</span> metrics_train <span class="sc">|&gt;</span></span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(metrics_valid) <span class="sc">|&gt;</span></span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(metrics_test) <span class="sc">|&gt;</span></span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">scenario =</span> simu_data<span class="sc">$</span>scenario,</span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">ind =</span> ind,</span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">repn =</span> simu_data<span class="sc">$</span>repn,</span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">min_bucket =</span> params<span class="sc">$</span>min_node_size,</span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">nb_leaves =</span> nb_leaves,</span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop_leaves =</span> nb_leaves <span class="sc">/</span> <span class="fu">nrow</span>(tb_train)</span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a>  tb_prop_scores <span class="ot">&lt;-</span> proq_scores_train <span class="sc">|&gt;</span></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(proq_scores_valid) <span class="sc">|&gt;</span></span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(proq_scores_test) <span class="sc">|&gt;</span></span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">scenario =</span> simu_data<span class="sc">$</span>scenario,</span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">ind =</span> ind,</span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a>      <span class="at">repn =</span> simu_data<span class="sc">$</span>repn,</span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a>      <span class="at">min_bucket =</span> params<span class="sc">$</span>min_node_size,</span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">nb_leaves =</span> nb_leaves,</span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop_leaves =</span> nb_leaves <span class="sc">/</span> <span class="fu">nrow</span>(tb_train)</span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a>  tb_disp_metrics <span class="ot">&lt;-</span> disp_train <span class="sc">|&gt;</span></span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(disp_test) <span class="sc">|&gt;</span></span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(disp_valid) <span class="sc">|&gt;</span></span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">scenario =</span> simu_data<span class="sc">$</span>scenario,</span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">ind =</span> ind,</span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">repn =</span> simu_data<span class="sc">$</span>repn,</span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">min_bucket =</span> params<span class="sc">$</span>min_node_size,</span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a>      <span class="at">nb_leaves =</span> nb_leaves,</span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop_leaves =</span> nb_leaves <span class="sc">/</span> <span class="fu">nrow</span>(tb_train)</span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">scenario =</span> simu_data<span class="sc">$</span>scenario,     <span class="co"># data scenario</span></span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">ind =</span> ind,                         <span class="co"># index for grid</span></span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">repn =</span> simu_data<span class="sc">$</span>repn,             <span class="co"># data replication ID</span></span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_bucket =</span> params<span class="sc">$</span>min_node_size, <span class="co"># min number of obs in terminal leaf node</span></span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> tb_metrics,              <span class="co"># table with performance/calib metrics</span></span>
<span id="cb16-152"><a href="#cb16-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">disp_metrics =</span> tb_disp_metrics,    <span class="co"># table with divergence metrics</span></span>
<span id="cb16-153"><a href="#cb16-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">tb_prop_scores =</span> tb_prop_scores,   <span class="co"># table with P(q1 &lt; score &lt; q2)</span></span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores_hist =</span> scores_hist,         <span class="co"># histogram of scores</span></span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_leaves =</span> nb_leaves              <span class="co"># number of terminal leaves</span></span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-157"><a href="#cb16-157" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We define a wrapper function, <code class="sourceCode r"><span class="fu">simulate_rf_scenario</span>()</code> which performs a single replication of the simulations going over the different values of the grid search, for a given scenario.</p>
<div class="cell">
<details class="code-fold">
<summary>Function <code class="sourceCode r"><span class="fu">simulate_rf_scenario</span>()</code></summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulations for a scenario (single replication)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @returns list with the following elements:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#'  - `metrics_all`: computed metrics for each set of hyperparameters. </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#'    Each row gives the values for unique keys </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'    (sample, min_bucket)</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#'  - `prop_scores_simul` P(q1 &lt; s(x) &lt; q2) for various values of q1 and q2</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'    Each row gives the values for unique keys </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#'    (sample, min_bucket, q1, q2)</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#'    q1, q2, min_bucket, type, sample)</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#'  - `metrics`: computed metrics for trees of interest </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#'    (smallest, largest, largest AUC, lowest MSE, lowest KL div.).</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#'    Each row gives the values for unique keys </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#'    (sample, type of tree of interest)</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>simulate_rf_scenario <span class="ot">&lt;-</span> <span class="cf">function</span>(scenario, params_df, repn) {</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate Data</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  simu_data <span class="ot">&lt;-</span> <span class="fu">simulate_data_wrapper</span>(</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">scenario =</span> scenario,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">params_df =</span> params_df,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">repn =</span> repn</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  res_simul <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">nrow</span>(grid))</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cli::cli_progress_bar("Iteration grid", total = nrow(grid), type = "tasks")</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid)) {</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    curent_params <span class="ot">&lt;-</span> grid <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="sc">!!</span>j)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    n_var <span class="ot">&lt;-</span> simu_data<span class="sc">$</span>params_df<span class="sc">$</span>n_num <span class="sc">+</span> simu_data<span class="sc">$</span>params_df<span class="sc">$</span>add_categ <span class="sc">*</span> <span class="dv">5</span> <span class="sc">+</span> </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>      simu_data<span class="sc">$</span>params_df<span class="sc">$</span>n_noise</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (curent_params<span class="sc">$</span>mtry <span class="sc">&gt;</span> n_var) {</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># cli::cli_progress_update()</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span>()</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    res_simul[[j]] <span class="ot">&lt;-</span> <span class="fu">simul_forest</span>(</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">params =</span> curent_params,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">ind =</span> curent_params<span class="sc">$</span>ind,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">simu_data =</span> simu_data</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cli::cli_progress_update()</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  metrics_simul <span class="ot">&lt;-</span> <span class="fu">map</span>(res_simul, <span class="st">"metrics"</span>) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  disp_metrics_simul <span class="ot">&lt;-</span> <span class="fu">map</span>(res_simul, <span class="st">"disp_metrics"</span>) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  metrics <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(metrics_simul, disp_metrics_simul)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  scores_hist <span class="ot">&lt;-</span> <span class="fu">map</span>(res_simul, <span class="st">"scores_hist"</span>)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  prop_scores_simul <span class="ot">&lt;-</span> <span class="fu">map</span>(res_simul, <span class="st">"tb_prop_scores"</span>) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Metrics for different trees in those estimated</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Smallest number of leaves</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Largest number of leaves</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Max AUC</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Min MSE</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Min KL</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify the smallest tree</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  smallest <span class="ot">&lt;-</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    metrics <span class="sc">|&gt;</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"test"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ind) <span class="sc">|&gt;</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"smallest"</span>)</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify the largest tree</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>  largest <span class="ot">&lt;-</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>    metrics <span class="sc">|&gt;</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"test"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(nb_leaves)) <span class="sc">|&gt;</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ind) <span class="sc">|&gt;</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"largest"</span>)</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify tree with highest AUC on test set</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>  highest_auc <span class="ot">&lt;-</span> metrics <span class="sc">|&gt;</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"test"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(AUC)) <span class="sc">|&gt;</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ind) <span class="sc">|&gt;</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"largest_auc"</span>)</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify tree with lowest MSE</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>  lowest_mse <span class="ot">&lt;-</span> metrics <span class="sc">|&gt;</span></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"test"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(mse) <span class="sc">|&gt;</span></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ind) <span class="sc">|&gt;</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"lowest_mse"</span>)</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify tree with lowest KL</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>  lowest_kl <span class="ot">&lt;-</span> metrics <span class="sc">|&gt;</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"test"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(KL_20_true_probas) <span class="sc">|&gt;</span></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ind) <span class="sc">|&gt;</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"lowest_kl"</span>)</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>  trees_of_interest <span class="ot">&lt;-</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>    smallest <span class="sc">|&gt;</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(largest) <span class="sc">|&gt;</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(highest_auc) <span class="sc">|&gt;</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(lowest_mse) <span class="sc">|&gt;</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(lowest_kl)</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>  trees_of_interest_metrics <span class="ot">&lt;-</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>    trees_of_interest <span class="sc">|&gt;</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>      metrics, </span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ind"</span>),</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">relationship =</span> <span class="st">"many-to-many"</span> <span class="co"># (train, test)</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>  trees_of_interest_prop_scores_simul <span class="ot">&lt;-</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>    trees_of_interest <span class="sc">|&gt;</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>      prop_scores_simul, </span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ind"</span>),</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">relationship =</span> <span class="st">"many-to-many"</span> <span class="co"># (train, test)</span></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics_all =</span> metrics,</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> trees_of_interest_metrics,</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores_hist =</span> scores_hist,</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_scores_simul =</span> trees_of_interest_prop_scores_simul</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulations" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="simulations"><span class="header-section-number">6.4</span> Simulations</h2>
<p>We loop over the scenarios and run the 100 replications in parallel.</p>
<div class="cell">
<details class="code-fold">
<summary>Simulation codes</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pbapply)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ncl <span class="ot">&lt;-</span> <span class="fu">detectCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>(cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(ncl))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(philentropy)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ranger)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ks)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>()</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  cl, <span class="fu">c</span>(</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Functions</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"brier_score"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"compute_metrics"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dispersion_metrics"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"prop_btw_quantiles"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"subset_target"</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"simulate_data"</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"simulate_data_wrapper"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"simul_forest"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"simulate_rf_scenario"</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Objects</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"grid"</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"params_df"</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"repns_vector"</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"output/simul/dgp-ojeda/"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_scenario <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  scenario <span class="ot">&lt;-</span> i_scenario</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">str_c</span>(<span class="st">"Scenario "</span>, scenario, <span class="st">"/"</span>, <span class="fu">nrow</span>(params_df)))</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clusterExport</span>(cl, <span class="fu">c</span>(<span class="st">"scenario"</span>))</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  resul_rf_scenario <span class="ot">&lt;-</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pblapply</span>(</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(repns_vector), <span class="cf">function</span>(i) <span class="fu">simulate_rf_scenario</span>(</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">scenario =</span> scenario, <span class="at">params_df =</span> params_df, <span class="at">repn =</span> repns_vector[i]</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">cl =</span> cl</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    resul_rf_scenario,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="fu">str_c</span>(<span class="st">"output/simul/dgp-ojeda/resul_rf_scenario_"</span>, scenario, <span class="st">".rda"</span>)</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The results can be loaded as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">str_c</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"output/simul/dgp-ojeda/resul_rf_scenario_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="st">".rda"</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>resul_rf <span class="ot">&lt;-</span> <span class="fu">map</span>(files[<span class="fu">file.exists</span>(files)], <span class="sc">~</span>{<span class="fu">load</span>(.x) ; resul_rf_scenario})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>resul_rf</code> object is of length 16: each element contains the simulations for a scenario. For each scenario, the elements are a list of length <code>max(repns_vector)</code>, i.e., the number of replications. Each replication gives, in a list, the following elements:</p>
<ul>
<li><code>metrics_all</code>: the metrics (AUC, Calibration, KL Divergence, etc.) for each model from the grid search <!-- - `metrics`: the metrics computed for some specific trees (smallest, largest, the one that minimises the test MSE, the one that minimises the test KL divergence between the estimated scores and the true probabilities, the one that maximises the AUC) --></li>
<li><code>scores_hist</code>: the counts on bins defined on estimated scores (on train, validation, and test sets)</li>
<li><code>prop_scores_simul</code>: the estimations of <span class="math inline">\(\mathbb{P}(q_1 &lt; \hat{\mathbf{x}}&lt; q_2)\)</span> for various values of <code>q_1</code> and <code>q_2</code>.</li>
</ul>
</section>
<section id="results" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="results"><span class="header-section-number">6.5</span> Results</h2>
<p>We can now extract some information from the results.</p>
<section id="tables" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="tables"><span class="header-section-number">6.5.1</span> Tables</h3>
<p>We can merge the metrics tables computed for each scenario and replications for these scenarios into a single tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>metrics_rf_all <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  resul_rf,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(resul_rf_sc) <span class="fu">map</span>(resul_rf_sc, <span class="st">"metrics_all"</span>) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">factor</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      sample,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"train"</span>, <span class="st">"test"</span>, <span class="st">"valid"</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Train"</span>, <span class="st">"Test"</span>, <span class="st">"Validation"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us exclude here the random forests with only 1 leaf in the nodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>metrics_rf_all <span class="ot">&lt;-</span> <span class="fu">filter</span>(metrics_rf_all, nb_leaves <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The metrics relative to the dispersion of the scores (i.e., <span class="math inline">\(P(q_1 &lt; \hat{s}(\mathbf{x}) &lt; q_2)\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>rf_prop_scores_simul <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  resul_rf, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(resul_rf_sc) <span class="fu">map</span>(resul_rf_sc, <span class="st">"prop_scores_simul"</span>) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And then, let us also get the trees of interest for each replication (smallest, largest, the one that maximizes the AUC, that minimizes the MSE, that minimizes the KL divergence).</p>
<div class="cell">
<details class="code-fold">
<summary>Code to identify forests of interest.</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the model with the smallest number of leaves on average on</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># validation set</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>smallest_rf <span class="ot">&lt;-</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Validation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario, repn) <span class="sc">|&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario, repn, ind, nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"smallest"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the largest tree</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>largest_rf <span class="ot">&lt;-</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Validation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario, repn) <span class="sc">|&gt;</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(nb_leaves)) <span class="sc">|&gt;</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario, repn, ind, nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"largest"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify tree with highest AUC on test set</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>highest_auc_rf <span class="ot">&lt;-</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Validation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario, repn) <span class="sc">|&gt;</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(AUC)) <span class="sc">|&gt;</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario, repn, ind, nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"largest_auc"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify tree with lowest MSE</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>lowest_mse_rf <span class="ot">&lt;-</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Validation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario, repn) <span class="sc">|&gt;</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mse) <span class="sc">|&gt;</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario, repn, ind, nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"lowest_mse"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify tree with lowest Brier</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>lowest_brier_rf <span class="ot">&lt;-</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>  metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Validation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario, repn) <span class="sc">|&gt;</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(brier) <span class="sc">|&gt;</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario, repn, ind, nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"lowest_brier"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify tree with lowest ICI</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>lowest_ici_rf <span class="ot">&lt;-</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>  metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Validation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario, repn) <span class="sc">|&gt;</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ici) <span class="sc">|&gt;</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario, repn, ind, nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"lowest_ici"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify tree with lowest KL</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>lowest_kl_rf <span class="ot">&lt;-</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>  metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Validation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario, repn) <span class="sc">|&gt;</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(KL_20_true_probas) <span class="sc">|&gt;</span></span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario, repn, ind, nb_leaves) <span class="sc">|&gt;</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result_type =</span> <span class="st">"lowest_kl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge these</span></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>rf_of_interest <span class="ot">&lt;-</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>  smallest_rf <span class="sc">|&gt;</span></span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(largest_rf) <span class="sc">|&gt;</span></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(highest_auc_rf) <span class="sc">|&gt;</span></span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(lowest_mse_rf) <span class="sc">|&gt;</span></span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(lowest_brier_rf) <span class="sc">|&gt;</span></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(lowest_ici_rf) <span class="sc">|&gt;</span></span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(lowest_kl_rf)</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Add metrics now</span></span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>rf_of_interest <span class="ot">&lt;-</span></span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>  rf_of_interest <span class="sc">|&gt;</span></span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>    metrics_rf_all,</span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"scenario"</span>, <span class="st">"repn"</span>, <span class="st">"ind"</span>, <span class="st">"nb_leaves"</span>),</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">relationship =</span> <span class="st">"many-to-many"</span> <span class="co"># (train, valid, test)</span></span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">result_type =</span> <span class="fu">factor</span>(</span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a>      result_type,</span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>        <span class="st">"smallest"</span>, <span class="st">"largest"</span>, <span class="st">"lowest_mse"</span>, <span class="st">"largest_auc"</span>,</span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>        <span class="st">"lowest_brier"</span>, <span class="st">"lowest_ici"</span>, <span class="st">"lowest_kl"</span>),</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Smallest"</span>, <span class="st">"Largest"</span>, <span class="st">"MSE*"</span>, <span class="st">"AUC*"</span>,</span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Brier*"</span>, <span class="st">"ICI*"</span>, <span class="st">"KL*"</span></span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity check</span></span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a><span class="co"># rf_of_interest |&gt; count(scenario, sample, result_type)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Codes to create the table</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>n_digits <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>table_to_print <span class="ot">&lt;-</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  rf_of_interest <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(scenario, sample, result_type) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_of</span>(<span class="fu">c</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mse"</span>, <span class="st">"AUC"</span>, <span class="st">"brier"</span>, <span class="st">"ici"</span>, <span class="st">"KL_20_true_probas"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"inter_quantile_10_90"</span>)),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">str_c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(.x), n_digits), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="fu">sd</span>(.x), n_digits), <span class="st">")"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(scenario, result_type) <span class="sc">|&gt;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scenario =</span> <span class="fu">str_c</span>(<span class="st">"Scenario "</span>, scenario))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>table_to_print <span class="sc">|&gt;</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">colnames =</span> <span class="fu">c</span>(</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Scenario"</span> <span class="ot">=</span> <span class="st">"scenario"</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Selected Tree"</span> <span class="ot">=</span> <span class="st">"result_type"</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sample"</span> <span class="ot">=</span> <span class="st">"sample"</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"ICI"</span> <span class="ot">=</span> <span class="st">"ici"</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"KL Div."</span> <span class="ot">=</span> <span class="st">"KL_20_true_probas"</span>,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Quant. Ratio"</span> <span class="ot">=</span> <span class="st">"inter_quantile_10_90"</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">extensions =</span> <span class="st">'RowGroup'</span>,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">rowGroup =</span> <span class="fu">list</span>(<span class="at">dataSrc =</span> <span class="fu">c</span>(<span class="dv">0</span>)),</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">iDisplayLength =</span> <span class="dv">21</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">formatStyle</span>(</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(table_to_print),</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> <span class="st">'row'</span>,</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">backgroundColor =</span> DT<span class="sc">::</span><span class="fu">styleEqual</span>(</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"Smallest"</span>, <span class="st">"Largest"</span>, <span class="st">"AUC*"</span>, <span class="st">"MSE*"</span>, <span class="st">"Brier*"</span>, <span class="st">"ICI*"</span>, <span class="st">"KL*"</span>),</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"#332288"</span>, <span class="st">"#117733"</span>, <span class="st">"#AA4499"</span>, <span class="st">"#882255"</span>,<span class="st">"#DDCC77"</span>, <span class="st">"#44AA99"</span>, <span class="st">"#949698"</span>)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"white"</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-rf-scenarios-results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rf-scenarios-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.2: Average Performance and Calibration Metrics Computed on Test Set Over 100 Replications Under Scenario 1. Standard errors between round brackets.
</figcaption>
<div aria-describedby="tbl-rf-scenarios-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e7878a0de7d3348525b6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e7878a0de7d3348525b6">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Train&quot;,&quot;Test&quot;,&quot;Validation&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Smallest&quot;,&quot;Largest&quot;,&quot;MSE*&quot;,&quot;AUC*&quot;,&quot;Brier*&quot;,&quot;ICI*&quot;,&quot;KL*&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["RowGroup"],"data":[["Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 1","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 2","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 3","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 4","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 5","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 6","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 7","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 8","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 9","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 10","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 11","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 12","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 13","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 14","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 15","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16","Scenario 16"],["Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation","Train","Test","Validation"],["Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*","Smallest","Smallest","Smallest","Largest","Largest","Largest","MSE*","MSE*","MSE*","AUC*","AUC*","AUC*","Brier*","Brier*","Brier*","ICI*","ICI*","ICI*","KL*","KL*","KL*"],["0.02 (0.001)","0.02 (0.001)","0.02 (0.001)","0.056 (0.001)","0.029 (0.001)","0.029 (0.001)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.003 (0.005)","0.003 (0.005)","0.003 (0.005)","0.004 (0.002)","0.004 (0.001)","0.004 (0.001)","0.04 (0.001)","0.04 (0.001)","0.04 (0.001)","0.05 (0.001)","0.006 (0)","0.006 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.014 (0.012)","0.003 (0.001)","0.003 (0.001)","0.035 (0.016)","0.005 (0.001)","0.005 (0.001)","0.048 (0.001)","0.048 (0.001)","0.048 (0.001)","0.055 (0.001)","0.021 (0.001)","0.021 (0.001)","0.013 (0.004)","0.005 (0)","0.005 (0)","0.008 (0.003)","0.005 (0.001)","0.005 (0.001)","0.015 (0.005)","0.005 (0)","0.005 (0)","0.035 (0.012)","0.005 (0.001)","0.005 (0.001)","0.054 (0.008)","0.006 (0.001)","0.006 (0.001)","0.049 (0.001)","0.049 (0.001)","0.049 (0.001)","0.058 (0.001)","0.032 (0.001)","0.032 (0.001)","0.031 (0.008)","0.011 (0.001)","0.011 (0.001)","0.016 (0.004)","0.012 (0.001)","0.012 (0.001)","0.032 (0.011)","0.011 (0.001)","0.011 (0.001)","0.042 (0.013)","0.015 (0.012)","0.015 (0.012)","0.052 (0.011)","0.011 (0.001)","0.011 (0.001)","0.019 (0)","0.02 (0)","0.02 (0)","0.032 (0.001)","0.017 (0.001)","0.017 (0.001)","0.001 (0)","0.001 (0)","0.001 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.008 (0.009)","0.008 (0.009)","0.008 (0.009)","0.004 (0.002)","0.004 (0.001)","0.004 (0.001)","0.035 (0.001)","0.035 (0.001)","0.035 (0.001)","0.029 (0.001)","0.004 (0)","0.004 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.002 (0)","0.006 (0.008)","0.002 (0.001)","0.002 (0.001)","0.018 (0.01)","0.004 (0.001)","0.004 (0.001)","0.041 (0.001)","0.041 (0.001)","0.041 (0.001)","0.032 (0.001)","0.018 (0.001)","0.018 (0.001)","0.013 (0.004)","0.004 (0)","0.004 (0)","0.006 (0.001)","0.005 (0.001)","0.005 (0.001)","0.014 (0.005)","0.004 (0)","0.004 (0)","0.023 (0.007)","0.004 (0)","0.004 (0)","0.033 (0.003)","0.005 (0)","0.005 (0)","0.042 (0.001)","0.042 (0.001)","0.042 (0.001)","0.035 (0.001)","0.027 (0.001)","0.027 (0.001)","0.029 (0.005)","0.008 (0)","0.008 (0)","0.011 (0.001)","0.011 (0.001)","0.011 (0.002)","0.028 (0.006)","0.008 (0)","0.008 (0)","0.033 (0.005)","0.013 (0.012)","0.013 (0.012)","0.034 (0.002)","0.008 (0)","0.008 (0)","0.021 (0)","0.021 (0)","0.021 (0)","0.043 (0.001)","0.005 (0)","0.005 (0)","0.003 (0)","0.003 (0)","0.003 (0)","0.004 (0.001)","0.003 (0.001)","0.003 (0.001)","0.003 (0)","0.003 (0)","0.003 (0)","0.02 (0.016)","0.005 (0.003)","0.005 (0.003)","0.03 (0.021)","0.006 (0.002)","0.006 (0.002)","0.024 (0)","0.024 (0)","0.024 (0)","0.053 (0.001)","0.006 (0)","0.006 (0)","0.004 (0)","0.003 (0)","0.003 (0)","0.005 (0.001)","0.004 (0.001)","0.004 (0.001)","0.004 (0.001)","0.003 (0)","0.003 (0)","0.025 (0.022)","0.004 (0.001)","0.004 (0.001)","0.043 (0.013)","0.005 (0.001)","0.005 (0.001)","0.026 (0)","0.026 (0)","0.026 (0)","0.057 (0.001)","0.014 (0)","0.014 (0)","0.013 (0.003)","0.006 (0)","0.006 (0)","0.008 (0.003)","0.006 (0.001)","0.006 (0.001)","0.016 (0.007)","0.006 (0)","0.006 (0)","0.056 (0.012)","0.006 (0)","0.006 (0)","0.049 (0.012)","0.006 (0)","0.006 (0)","0.026 (0)","0.026 (0)","0.026 (0)","0.059 (0.001)","0.018 (0)","0.018 (0)","0.024 (0.007)","0.009 (0)","0.009 (0)","0.011 (0.002)","0.01 (0.001)","0.01 (0.001)","0.027 (0.011)","0.009 (0)","0.009 (0)","0.047 (0.016)","0.014 (0.008)","0.014 (0.008)","0.051 (0.012)","0.009 (0)","0.009 (0.001)","0.035 (0.001)","0.035 (0.001)","0.035 (0.001)","0.053 (0.001)","0.019 (0.001)","0.019 (0.001)","0.006 (0)","0.006 (0)","0.006 (0)","0.006 (0)","0.006 (0)","0.006 (0)","0.006 (0)","0.006 (0)","0.006 (0)","0.006 (0.001)","0.006 (0.001)","0.006 (0.001)","0.01 (0.002)","0.008 (0.001)","0.008 (0.001)","0.044 (0.001)","0.044 (0.001)","0.044 (0.001)","0.052 (0.001)","0.012 (0.001)","0.012 (0.001)","0.007 (0.001)","0.006 (0)","0.006 (0)","0.007 (0.001)","0.006 (0)","0.006 (0)","0.007 (0.001)","0.006 (0)","0.006 (0)","0.015 (0.013)","0.007 (0.001)","0.007 (0.001)","0.056 (0.006)","0.01 (0.001)","0.01 (0.001)","0.048 (0.001)","0.048 (0.001)","0.049 (0.001)","0.058 (0.001)","0.03 (0.001)","0.03 (0.001)","0.026 (0.006)","0.013 (0.001)","0.013 (0.001)","0.022 (0.008)","0.013 (0.001)","0.013 (0.001)","0.027 (0.008)","0.013 (0.001)","0.013 (0.001)","0.04 (0.011)","0.013 (0.001)","0.013 (0.001)","0.053 (0.009)","0.013 (0.001)","0.013 (0.001)","0.049 (0.001)","0.049 (0.001)","0.049 (0)","0.06 (0.001)","0.038 (0.001)","0.038 (0.001)","0.035 (0.007)","0.021 (0.001)","0.021 (0.001)","0.027 (0.009)","0.021 (0.001)","0.021 (0.001)","0.036 (0.01)","0.021 (0.001)","0.021 (0.001)","0.049 (0.007)","0.041 (0.013)","0.041 (0.013)","0.051 (0.01)","0.021 (0.001)","0.021 (0.001)"],["0.699 (0.006)","0.697 (0.007)","0.698 (0.006)","0.998 (0)","0.706 (0.006)","0.706 (0.006)","0.766 (0.005)","0.756 (0.005)","0.756 (0.005)","0.766 (0.005)","0.756 (0.005)","0.756 (0.005)","0.766 (0.005)","0.756 (0.005)","0.756 (0.005)","0.76 (0.022)","0.749 (0.018)","0.749 (0.02)","0.796 (0.015)","0.75 (0.006)","0.749 (0.006)","0.728 (0.005)","0.722 (0.006)","0.721 (0.006)","1 (0)","0.746 (0.005)","0.746 (0.005)","0.775 (0.005)","0.755 (0.005)","0.755 (0.005)","0.775 (0.007)","0.755 (0.005)","0.755 (0.005)","0.775 (0.006)","0.755 (0.005)","0.755 (0.005)","0.908 (0.078)","0.751 (0.006)","0.75 (0.006)","0.979 (0.035)","0.746 (0.006)","0.745 (0.005)","0.711 (0.012)","0.696 (0.015)","0.696 (0.015)","1 (0)","0.733 (0.005)","0.733 (0.005)","0.957 (0.023)","0.75 (0.005)","0.751 (0.005)","0.889 (0.038)","0.751 (0.005)","0.752 (0.005)","0.959 (0.029)","0.75 (0.005)","0.751 (0.005)","0.997 (0.006)","0.749 (0.005)","0.748 (0.005)","1 (0)","0.747 (0.005)","0.747 (0.005)","0.677 (0.032)","0.655 (0.035)","0.655 (0.036)","1 (0)","0.713 (0.005)","0.714 (0.006)","0.998 (0.004)","0.745 (0.005)","0.745 (0.005)","0.952 (0.036)","0.746 (0.005)","0.747 (0.005)","0.998 (0.004)","0.745 (0.005)","0.746 (0.005)","0.958 (0.124)","0.726 (0.054)","0.726 (0.054)","1 (0)","0.744 (0.005)","0.744 (0.005)","0.744 (0.007)","0.743 (0.008)","0.742 (0.008)","0.998 (0)","0.801 (0.006)","0.8 (0.005)","0.854 (0.005)","0.839 (0.005)","0.839 (0.005)","0.851 (0.005)","0.839 (0.005)","0.839 (0.005)","0.854 (0.005)","0.839 (0.005)","0.839 (0.005)","0.818 (0.055)","0.806 (0.047)","0.805 (0.049)","0.89 (0.016)","0.831 (0.006)","0.831 (0.006)","0.794 (0.005)","0.789 (0.006)","0.788 (0.006)","1 (0)","0.827 (0.005)","0.827 (0.005)","0.865 (0.005)","0.838 (0.005)","0.838 (0.005)","0.859 (0.007)","0.838 (0.005)","0.838 (0.005)","0.865 (0.008)","0.838 (0.005)","0.838 (0.005)","0.907 (0.051)","0.835 (0.006)","0.835 (0.005)","0.979 (0.029)","0.83 (0.006)","0.829 (0.006)","0.771 (0.015)","0.757 (0.018)","0.757 (0.019)","1 (0)","0.803 (0.007)","0.803 (0.007)","0.989 (0.008)","0.83 (0.005)","0.83 (0.005)","0.927 (0.024)","0.832 (0.005)","0.832 (0.005)","0.988 (0.009)","0.83 (0.005)","0.83 (0.005)","0.998 (0.003)","0.828 (0.005)","0.828 (0.005)","1 (0)","0.826 (0.005)","0.826 (0.005)","0.729 (0.038)","0.707 (0.042)","0.706 (0.042)","1 (0)","0.778 (0.007)","0.779 (0.008)","1 (0)","0.821 (0.005)","0.821 (0.006)","0.96 (0.025)","0.824 (0.005)","0.825 (0.005)","1 (0)","0.821 (0.005)","0.821 (0.005)","0.951 (0.129)","0.792 (0.075)","0.791 (0.077)","1 (0)","0.82 (0.006)","0.82 (0.006)","0.656 (0.006)","0.652 (0.006)","0.651 (0.006)","1 (0)","0.672 (0.005)","0.671 (0.005)","0.756 (0.008)","0.683 (0.005)","0.681 (0.005)","0.759 (0.03)","0.682 (0.005)","0.682 (0.005)","0.759 (0.021)","0.682 (0.005)","0.681 (0.005)","0.893 (0.126)","0.673 (0.018)","0.671 (0.018)","0.952 (0.063)","0.672 (0.008)","0.671 (0.007)","0.658 (0.008)","0.65 (0.007)","0.649 (0.007)","1 (0)","0.674 (0.006)","0.672 (0.005)","0.782 (0.019)","0.681 (0.006)","0.679 (0.005)","0.805 (0.048)","0.681 (0.006)","0.68 (0.005)","0.788 (0.039)","0.68 (0.006)","0.679 (0.005)","0.926 (0.086)","0.676 (0.006)","0.675 (0.005)","0.997 (0.011)","0.673 (0.006)","0.671 (0.005)","0.644 (0.012)","0.625 (0.013)","0.624 (0.011)","1 (0)","0.657 (0.006)","0.656 (0.005)","0.976 (0.019)","0.677 (0.006)","0.675 (0.005)","0.871 (0.066)","0.678 (0.006)","0.677 (0.005)","0.98 (0.022)","0.676 (0.006)","0.676 (0.005)","1 (0)","0.672 (0.006)","0.67 (0.005)","1 (0)","0.673 (0.006)","0.671 (0.005)","0.617 (0.017)","0.591 (0.018)","0.591 (0.017)","1 (0)","0.634 (0.007)","0.633 (0.005)","0.999 (0.003)","0.672 (0.006)","0.671 (0.005)","0.904 (0.063)","0.675 (0.006)","0.674 (0.005)","0.999 (0.004)","0.672 (0.006)","0.672 (0.005)","0.88 (0.189)","0.638 (0.047)","0.635 (0.047)","1 (0)","0.669 (0.006)","0.667 (0.006)","0.665 (0.005)","0.661 (0.008)","0.661 (0.006)","0.999 (0)","0.717 (0.006)","0.716 (0.005)","0.792 (0.006)","0.743 (0.006)","0.743 (0.005)","0.793 (0.009)","0.743 (0.006)","0.743 (0.004)","0.793 (0.008)","0.743 (0.006)","0.743 (0.004)","0.79 (0.013)","0.742 (0.006)","0.743 (0.005)","0.867 (0.023)","0.738 (0.006)","0.738 (0.005)","0.677 (0.006)","0.67 (0.007)","0.67 (0.006)","1 (0)","0.73 (0.006)","0.73 (0.005)","0.836 (0.013)","0.741 (0.006)","0.741 (0.005)","0.837 (0.022)","0.741 (0.006)","0.742 (0.005)","0.84 (0.019)","0.741 (0.006)","0.742 (0.005)","0.893 (0.07)","0.739 (0.006)","0.739 (0.005)","1 (0.001)","0.731 (0.006)","0.732 (0.005)","0.658 (0.013)","0.641 (0.014)","0.641 (0.014)","1 (0)","0.698 (0.006)","0.698 (0.005)","0.991 (0.01)","0.729 (0.006)","0.73 (0.005)","0.977 (0.022)","0.73 (0.006)","0.731 (0.005)","0.993 (0.011)","0.729 (0.006)","0.73 (0.005)","0.999 (0.003)","0.728 (0.006)","0.728 (0.005)","1 (0)","0.728 (0.006)","0.728 (0.005)","0.629 (0.019)","0.605 (0.02)","0.605 (0.021)","1 (0)","0.666 (0.006)","0.667 (0.007)","1 (0.001)","0.718 (0.006)","0.718 (0.005)","0.99 (0.014)","0.718 (0.006)","0.719 (0.005)","0.999 (0.002)","0.717 (0.006)","0.718 (0.005)","0.728 (0.184)","0.624 (0.062)","0.624 (0.063)","1 (0)","0.716 (0.006)","0.716 (0.005)"],["0.219 (0.002)","0.219 (0.002)","0.219 (0.002)","0.062 (0.001)","0.228 (0.003)","0.228 (0.003)","0.197 (0.002)","0.201 (0.002)","0.201 (0.002)","0.197 (0.002)","0.201 (0.002)","0.201 (0.002)","0.197 (0.002)","0.201 (0.002)","0.201 (0.002)","0.198 (0.006)","0.203 (0.005)","0.203 (0.005)","0.185 (0.006)","0.203 (0.002)","0.203 (0.002)","0.239 (0.001)","0.239 (0.001)","0.239 (0.001)","0.053 (0)","0.205 (0.002)","0.205 (0.002)","0.193 (0.002)","0.201 (0.002)","0.201 (0.002)","0.194 (0.003)","0.201 (0.002)","0.201 (0.002)","0.193 (0.002)","0.201 (0.002)","0.201 (0.002)","0.133 (0.041)","0.203 (0.002)","0.203 (0.002)","0.081 (0.033)","0.205 (0.002)","0.205 (0.002)","0.247 (0.001)","0.247 (0.001)","0.247 (0.001)","0.056 (0)","0.221 (0.001)","0.221 (0.001)","0.123 (0.014)","0.204 (0.002)","0.204 (0.002)","0.158 (0.018)","0.205 (0.002)","0.205 (0.002)","0.121 (0.019)","0.204 (0.002)","0.204 (0.002)","0.074 (0.018)","0.205 (0.002)","0.205 (0.002)","0.05 (0.009)","0.205 (0.002)","0.205 (0.002)","0.248 (0.001)","0.249 (0.001)","0.249 (0.001)","0.058 (0)","0.231 (0.001)","0.231 (0.001)","0.086 (0.016)","0.21 (0.001)","0.21 (0.001)","0.142 (0.024)","0.211 (0.002)","0.211 (0.002)","0.086 (0.02)","0.21 (0.001)","0.21 (0.001)","0.09 (0.057)","0.214 (0.012)","0.214 (0.012)","0.056 (0.014)","0.21 (0.001)","0.21 (0.001)","0.137 (0.002)","0.137 (0.002)","0.137 (0.002)","0.038 (0.001)","0.134 (0.003)","0.135 (0.002)","0.115 (0.002)","0.119 (0.002)","0.119 (0.002)","0.116 (0.002)","0.119 (0.002)","0.119 (0.002)","0.115 (0.002)","0.119 (0.002)","0.119 (0.002)","0.122 (0.011)","0.125 (0.009)","0.126 (0.009)","0.103 (0.006)","0.121 (0.002)","0.121 (0.002)","0.152 (0.002)","0.152 (0.002)","0.152 (0.002)","0.033 (0)","0.122 (0.002)","0.122 (0.002)","0.112 (0.002)","0.119 (0.002)","0.119 (0.002)","0.113 (0.002)","0.119 (0.002)","0.119 (0.002)","0.112 (0.003)","0.119 (0.002)","0.119 (0.002)","0.093 (0.026)","0.12 (0.002)","0.12 (0.002)","0.055 (0.022)","0.121 (0.002)","0.122 (0.002)","0.158 (0.002)","0.158 (0.002)","0.159 (0.002)","0.037 (0.001)","0.136 (0.002)","0.136 (0.002)","0.06 (0.009)","0.121 (0.002)","0.122 (0.002)","0.096 (0.011)","0.122 (0.002)","0.123 (0.002)","0.06 (0.011)","0.121 (0.002)","0.122 (0.002)","0.041 (0.01)","0.122 (0.002)","0.122 (0.002)","0.029 (0.003)","0.122 (0.002)","0.122 (0.002)","0.159 (0.002)","0.159 (0.002)","0.16 (0.002)","0.039 (0.001)","0.145 (0.002)","0.145 (0.002)","0.036 (0.008)","0.126 (0.002)","0.126 (0.002)","0.093 (0.015)","0.128 (0.002)","0.129 (0.002)","0.037 (0.008)","0.126 (0.002)","0.126 (0.002)","0.049 (0.044)","0.13 (0.012)","0.131 (0.012)","0.029 (0.002)","0.126 (0.002)","0.126 (0.002)","0.239 (0.001)","0.239 (0.001)","0.239 (0.001)","0.073 (0.001)","0.223 (0.001)","0.224 (0.002)","0.202 (0.002)","0.221 (0.001)","0.221 (0.001)","0.204 (0.008)","0.221 (0.001)","0.222 (0.001)","0.201 (0.006)","0.221 (0.001)","0.221 (0.001)","0.14 (0.056)","0.223 (0.004)","0.223 (0.004)","0.108 (0.046)","0.224 (0.002)","0.224 (0.002)","0.242 (0.001)","0.242 (0.001)","0.242 (0.001)","0.06 (0)","0.224 (0.001)","0.224 (0.001)","0.195 (0.005)","0.221 (0.002)","0.222 (0.001)","0.194 (0.013)","0.222 (0.002)","0.222 (0.001)","0.193 (0.011)","0.221 (0.002)","0.221 (0.001)","0.124 (0.054)","0.222 (0.002)","0.223 (0.002)","0.076 (0.02)","0.223 (0.002)","0.224 (0.002)","0.244 (0.001)","0.244 (0.001)","0.244 (0.001)","0.059 (0)","0.232 (0.001)","0.232 (0.001)","0.14 (0.014)","0.224 (0.001)","0.224 (0.001)","0.182 (0.022)","0.224 (0.002)","0.224 (0.001)","0.132 (0.022)","0.224 (0.001)","0.224 (0.001)","0.059 (0.016)","0.224 (0.001)","0.225 (0.001)","0.067 (0.016)","0.224 (0.001)","0.224 (0.001)","0.244 (0.001)","0.244 (0.001)","0.244 (0.001)","0.06 (0)","0.236 (0.001)","0.237 (0.001)","0.115 (0.018)","0.227 (0.001)","0.227 (0.001)","0.187 (0.022)","0.228 (0.002)","0.228 (0.001)","0.11 (0.024)","0.227 (0.001)","0.227 (0.001)","0.114 (0.084)","0.232 (0.008)","0.233 (0.008)","0.066 (0.015)","0.227 (0.001)","0.228 (0.001)","0.235 (0.001)","0.235 (0.001)","0.235 (0.001)","0.058 (0.001)","0.219 (0.003)","0.219 (0.002)","0.188 (0.003)","0.206 (0.002)","0.205 (0.002)","0.187 (0.004)","0.206 (0.002)","0.205 (0.002)","0.187 (0.003)","0.206 (0.002)","0.205 (0.002)","0.188 (0.005)","0.206 (0.002)","0.206 (0.002)","0.156 (0.01)","0.208 (0.003)","0.208 (0.002)","0.244 (0.001)","0.244 (0.001)","0.244 (0.001)","0.054 (0)","0.212 (0.002)","0.212 (0.001)","0.172 (0.005)","0.206 (0.002)","0.206 (0.002)","0.172 (0.009)","0.206 (0.002)","0.206 (0.002)","0.17 (0.007)","0.206 (0.002)","0.206 (0.002)","0.141 (0.04)","0.207 (0.002)","0.207 (0.002)","0.05 (0.007)","0.21 (0.002)","0.21 (0.002)","0.248 (0)","0.249 (0)","0.249 (0)","0.058 (0)","0.23 (0.001)","0.23 (0.001)","0.103 (0.017)","0.213 (0.002)","0.213 (0.001)","0.117 (0.024)","0.213 (0.001)","0.213 (0.001)","0.1 (0.019)","0.213 (0.002)","0.213 (0.001)","0.074 (0.018)","0.213 (0.002)","0.213 (0.001)","0.056 (0.012)","0.213 (0.002)","0.213 (0.001)","0.249 (0)","0.249 (0)","0.249 (0)","0.06 (0)","0.238 (0.001)","0.238 (0.001)","0.093 (0.018)","0.221 (0.001)","0.221 (0.001)","0.123 (0.027)","0.221 (0.001)","0.221 (0.001)","0.092 (0.023)","0.221 (0.001)","0.221 (0.001)","0.194 (0.084)","0.241 (0.013)","0.241 (0.013)","0.064 (0.015)","0.221 (0.001)","0.221 (0.001)"],["0.032 (0.007)","0.032 (0.008)","0.032 (0.007)","0.176 (0.003)","0.092 (0.005)","0.092 (0.005)","0.006 (0.001)","0.011 (0.004)","0.011 (0.004)","0.007 (0.001)","0.011 (0.004)","0.011 (0.004)","0.007 (0.001)","0.01 (0.003)","0.011 (0.004)","0.009 (0.003)","0.011 (0.004)","0.009 (0.004)","0.021 (0.009)","0.017 (0.006)","0.017 (0.006)","0.148 (0.006)","0.145 (0.006)","0.146 (0.006)","0.207 (0.002)","0.018 (0.005)","0.018 (0.005)","0.015 (0.002)","0.01 (0.003)","0.011 (0.004)","0.016 (0.005)","0.011 (0.005)","0.011 (0.004)","0.015 (0.003)","0.01 (0.004)","0.011 (0.004)","0.127 (0.068)","0.01 (0.004)","0.008 (0.004)","0.182 (0.031)","0.013 (0.005)","0.013 (0.004)","0.154 (0.012)","0.144 (0.015)","0.144 (0.015)","0.231 (0.001)","0.096 (0.005)","0.096 (0.005)","0.188 (0.024)","0.03 (0.005)","0.03 (0.005)","0.133 (0.028)","0.038 (0.007)","0.038 (0.008)","0.191 (0.03)","0.031 (0.005)","0.031 (0.005)","0.224 (0.014)","0.028 (0.005)","0.027 (0.005)","0.203 (0.013)","0.029 (0.005)","0.029 (0.005)","0.128 (0.029)","0.113 (0.031)","0.113 (0.032)","0.238 (0.001)","0.11 (0.004)","0.111 (0.005)","0.263 (0.013)","0.062 (0.005)","0.061 (0.005)","0.225 (0.035)","0.07 (0.007)","0.071 (0.007)","0.26 (0.02)","0.062 (0.006)","0.062 (0.005)","0.226 (0.062)","0.059 (0.008)","0.059 (0.008)","0.223 (0.025)","0.062 (0.005)","0.062 (0.005)","0.012 (0.004)","0.013 (0.004)","0.013 (0.004)","0.102 (0.002)","0.052 (0.004)","0.053 (0.004)","0.007 (0.001)","0.008 (0.003)","0.008 (0.004)","0.007 (0.001)","0.009 (0.003)","0.009 (0.003)","0.007 (0.001)","0.008 (0.003)","0.009 (0.003)","0.009 (0.003)","0.009 (0.003)","0.007 (0.003)","0.023 (0.009)","0.013 (0.005)","0.014 (0.005)","0.126 (0.005)","0.125 (0.005)","0.125 (0.004)","0.125 (0.002)","0.02 (0.004)","0.019 (0.004)","0.015 (0.002)","0.009 (0.003)","0.009 (0.003)","0.014 (0.003)","0.009 (0.003)","0.009 (0.004)","0.016 (0.003)","0.009 (0.003)","0.009 (0.003)","0.046 (0.037)","0.009 (0.003)","0.007 (0.003)","0.1 (0.024)","0.011 (0.004)","0.011 (0.004)","0.132 (0.011)","0.126 (0.013)","0.126 (0.013)","0.152 (0.002)","0.084 (0.004)","0.084 (0.005)","0.13 (0.007)","0.027 (0.004)","0.026 (0.004)","0.088 (0.013)","0.037 (0.007)","0.037 (0.007)","0.129 (0.008)","0.027 (0.004)","0.027 (0.004)","0.131 (0.008)","0.025 (0.004)","0.024 (0.004)","0.121 (0.004)","0.026 (0.004)","0.025 (0.005)","0.109 (0.025)","0.098 (0.027)","0.098 (0.027)","0.16 (0.002)","0.098 (0.004)","0.098 (0.004)","0.14 (0.012)","0.05 (0.004)","0.05 (0.004)","0.142 (0.014)","0.065 (0.009)","0.066 (0.008)","0.142 (0.013)","0.05 (0.005)","0.05 (0.005)","0.123 (0.031)","0.049 (0.006)","0.048 (0.007)","0.13 (0.004)","0.05 (0.004)","0.05 (0.005)","0.09 (0.004)","0.087 (0.005)","0.086 (0.006)","0.247 (0.002)","0.008 (0.003)","0.009 (0.004)","0.056 (0.005)","0.01 (0.004)","0.01 (0.004)","0.073 (0.022)","0.023 (0.012)","0.022 (0.012)","0.058 (0.014)","0.011 (0.004)","0.01 (0.004)","0.169 (0.095)","0.009 (0.004)","0.006 (0.004)","0.194 (0.05)","0.017 (0.006)","0.017 (0.005)","0.101 (0.006)","0.096 (0.005)","0.094 (0.005)","0.234 (0.001)","0.03 (0.005)","0.028 (0.005)","0.075 (0.013)","0.01 (0.004)","0.01 (0.004)","0.111 (0.036)","0.027 (0.012)","0.026 (0.012)","0.081 (0.03)","0.011 (0.004)","0.01 (0.004)","0.183 (0.066)","0.009 (0.003)","0.007 (0.003)","0.235 (0.02)","0.011 (0.004)","0.011 (0.004)","0.097 (0.009)","0.083 (0.009)","0.082 (0.008)","0.237 (0.001)","0.059 (0.004)","0.058 (0.004)","0.272 (0.022)","0.033 (0.005)","0.032 (0.005)","0.183 (0.049)","0.042 (0.009)","0.041 (0.009)","0.274 (0.024)","0.033 (0.005)","0.032 (0.005)","0.228 (0.026)","0.028 (0.005)","0.026 (0.005)","0.243 (0.026)","0.028 (0.005)","0.027 (0.005)","0.077 (0.013)","0.06 (0.013)","0.06 (0.012)","0.24 (0.001)","0.056 (0.004)","0.056 (0.004)","0.314 (0.018)","0.051 (0.005)","0.05 (0.005)","0.239 (0.054)","0.063 (0.008)","0.062 (0.008)","0.307 (0.027)","0.051 (0.005)","0.05 (0.005)","0.184 (0.087)","0.046 (0.006)","0.043 (0.005)","0.247 (0.028)","0.047 (0.005)","0.046 (0.005)","0.068 (0.006)","0.068 (0.009)","0.067 (0.007)","0.19 (0.002)","0.058 (0.005)","0.058 (0.004)","0.035 (0.003)","0.011 (0.004)","0.01 (0.004)","0.035 (0.004)","0.011 (0.004)","0.01 (0.004)","0.035 (0.004)","0.011 (0.004)","0.01 (0.004)","0.035 (0.006)","0.01 (0.004)","0.009 (0.004)","0.079 (0.017)","0.022 (0.006)","0.021 (0.005)","0.11 (0.005)","0.105 (0.007)","0.105 (0.005)","0.217 (0.002)","0.033 (0.006)","0.033 (0.005)","0.072 (0.009)","0.011 (0.004)","0.01 (0.004)","0.073 (0.015)","0.011 (0.005)","0.011 (0.004)","0.075 (0.014)","0.011 (0.004)","0.01 (0.004)","0.12 (0.059)","0.011 (0.004)","0.009 (0.004)","0.193 (0.008)","0.015 (0.004)","0.015 (0.004)","0.109 (0.009)","0.096 (0.01)","0.097 (0.01)","0.237 (0.001)","0.085 (0.005)","0.085 (0.004)","0.257 (0.013)","0.043 (0.006)","0.043 (0.005)","0.241 (0.023)","0.045 (0.007)","0.045 (0.006)","0.256 (0.014)","0.043 (0.006)","0.044 (0.005)","0.244 (0.021)","0.043 (0.006)","0.042 (0.005)","0.221 (0.02)","0.043 (0.006)","0.043 (0.005)","0.088 (0.014)","0.071 (0.014)","0.072 (0.016)","0.242 (0.001)","0.08 (0.005)","0.081 (0.005)","0.287 (0.021)","0.07 (0.006)","0.07 (0.005)","0.295 (0.023)","0.073 (0.006)","0.074 (0.005)","0.284 (0.029)","0.07 (0.006)","0.071 (0.005)","0.127 (0.088)","0.059 (0.011)","0.059 (0.011)","0.243 (0.028)","0.069 (0.006)","0.069 (0.005)"],["2.141 (0.206)","2.145 (0.207)","2.14 (0.201)","0.683 (0.035)","0.253 (0.03)","0.252 (0.031)","0.055 (0.017)","0.054 (0.017)","0.054 (0.016)","0.058 (0.022)","0.058 (0.022)","0.058 (0.021)","0.054 (0.017)","0.054 (0.017)","0.054 (0.017)","0.241 (0.604)","0.241 (0.605)","0.242 (0.608)","0.026 (0.008)","0.026 (0.008)","0.025 (0.009)","2.635 (0.202)","2.636 (0.202)","2.639 (0.202)","0.566 (0.012)","0.079 (0.014)","0.079 (0.015)","0.048 (0.017)","0.048 (0.016)","0.049 (0.017)","0.055 (0.026)","0.055 (0.026)","0.056 (0.026)","0.049 (0.018)","0.05 (0.019)","0.05 (0.019)","0.085 (0.114)","0.034 (0.032)","0.034 (0.032)","0.319 (0.245)","0.01 (0.005)","0.009 (0.004)","2.965 (0.221)","2.97 (0.226)","2.969 (0.22)","1.165 (0.035)","0.91 (0.041)","0.909 (0.037)","0.127 (0.016)","0.194 (0.028)","0.192 (0.027)","0.194 (0.057)","0.265 (0.054)","0.265 (0.054)","0.136 (0.028)","0.196 (0.029)","0.195 (0.03)","0.346 (0.192)","0.154 (0.022)","0.153 (0.021)","0.698 (0.173)","0.141 (0.018)","0.14 (0.017)","3.194 (0.387)","3.204 (0.385)","3.201 (0.389)","1.534 (0.037)","1.47 (0.047)","1.471 (0.049)","0.431 (0.118)","0.472 (0.031)","0.469 (0.029)","0.393 (0.088)","0.585 (0.078)","0.584 (0.074)","0.461 (0.188)","0.474 (0.034)","0.472 (0.03)","0.903 (0.936)","0.768 (0.936)","0.769 (0.944)","0.823 (0.238)","0.452 (0.029)","0.45 (0.026)","2.362 (0.111)","2.365 (0.114)","2.366 (0.115)","0.266 (0.03)","0.093 (0.018)","0.093 (0.018)","0.036 (0.014)","0.036 (0.013)","0.036 (0.013)","0.043 (0.015)","0.043 (0.015)","0.044 (0.016)","0.037 (0.014)","0.037 (0.013)","0.037 (0.014)","0.787 (1.121)","0.788 (1.122)","0.785 (1.119)","0.016 (0.006)","0.016 (0.007)","0.015 (0.006)","2.735 (0.15)","2.742 (0.15)","2.742 (0.148)","0.243 (0.009)","0.084 (0.015)","0.083 (0.015)","0.026 (0.01)","0.026 (0.009)","0.027 (0.01)","0.035 (0.013)","0.035 (0.014)","0.036 (0.014)","0.027 (0.012)","0.027 (0.012)","0.028 (0.013)","0.047 (0.067)","0.022 (0.019)","0.023 (0.019)","0.111 (0.103)","0.007 (0.003)","0.007 (0.003)","2.99 (0.209)","2.998 (0.207)","2.999 (0.218)","1.027 (0.044)","1.098 (0.04)","1.097 (0.038)","0.108 (0.019)","0.175 (0.033)","0.173 (0.033)","0.28 (0.119)","0.373 (0.113)","0.371 (0.111)","0.119 (0.042)","0.178 (0.041)","0.178 (0.04)","0.195 (0.088)","0.135 (0.029)","0.135 (0.028)","0.332 (0.047)","0.116 (0.019)","0.116 (0.018)","3.249 (0.42)","3.26 (0.41)","3.261 (0.417)","1.471 (0.034)","1.649 (0.045)","1.646 (0.044)","0.45 (0.052)","0.52 (0.054)","0.519 (0.054)","0.707 (0.13)","0.843 (0.109)","0.843 (0.109)","0.446 (0.051)","0.527 (0.058)","0.526 (0.056)","0.87 (1.036)","0.891 (1.022)","0.889 (1.019)","0.503 (0.034)","0.49 (0.039)","0.489 (0.037)","1.945 (0.103)","1.943 (0.103)","1.944 (0.102)","0.829 (0.02)","0.029 (0.008)","0.029 (0.009)","0.029 (0.009)","0.034 (0.01)","0.035 (0.011)","0.106 (0.075)","0.12 (0.08)","0.12 (0.079)","0.03 (0.014)","0.036 (0.015)","0.036 (0.016)","0.382 (0.486)","0.123 (0.403)","0.123 (0.403)","0.576 (0.559)","0.007 (0.003)","0.006 (0.003)","2.827 (0.178)","2.83 (0.173)","2.831 (0.177)","1.327 (0.029)","0.199 (0.024)","0.198 (0.023)","0.031 (0.012)","0.042 (0.013)","0.042 (0.013)","0.124 (0.087)","0.159 (0.095)","0.159 (0.094)","0.033 (0.016)","0.044 (0.018)","0.045 (0.017)","0.479 (0.607)","0.033 (0.018)","0.033 (0.019)","0.875 (0.476)","0.011 (0.005)","0.01 (0.005)","3.196 (0.039)","3.196 (0.04)","3.197 (0.042)","1.813 (0.038)","0.839 (0.033)","0.841 (0.031)","0.113 (0.037)","0.227 (0.029)","0.227 (0.028)","0.23 (0.12)","0.327 (0.1)","0.327 (0.099)","0.179 (0.169)","0.225 (0.031)","0.224 (0.03)","1.461 (0.468)","0.194 (0.026)","0.194 (0.025)","1.179 (0.475)","0.191 (0.025)","0.189 (0.025)","3.196 (0.039)","3.196 (0.04)","3.197 (0.042)","2.022 (0.038)","1.243 (0.036)","1.245 (0.036)","0.456 (0.224)","0.486 (0.039)","0.487 (0.04)","0.475 (0.187)","0.679 (0.122)","0.68 (0.124)","0.556 (0.362)","0.487 (0.042)","0.487 (0.042)","2.028 (0.837)","1.259 (1.245)","1.26 (1.247)","1.391 (0.443)","0.461 (0.036)","0.46 (0.035)","1.628 (0.177)","1.63 (0.174)","1.629 (0.173)","0.531 (0.022)","0.052 (0.011)","0.051 (0.012)","0.033 (0.012)","0.036 (0.013)","0.036 (0.012)","0.033 (0.014)","0.036 (0.014)","0.036 (0.014)","0.033 (0.013)","0.036 (0.014)","0.036 (0.014)","0.04 (0.018)","0.042 (0.018)","0.042 (0.018)","0.016 (0.008)","0.011 (0.004)","0.01 (0.004)","2.763 (0.049)","2.768 (0.058)","2.772 (0.054)","0.701 (0.019)","0.198 (0.021)","0.198 (0.022)","0.043 (0.013)","0.055 (0.016)","0.055 (0.017)","0.045 (0.016)","0.056 (0.018)","0.056 (0.019)","0.042 (0.013)","0.053 (0.015)","0.053 (0.016)","0.102 (0.16)","0.05 (0.02)","0.05 (0.019)","0.665 (0.126)","0.014 (0.005)","0.013 (0.005)","2.942 (0.251)","2.95 (0.259)","2.954 (0.257)","1.414 (0.035)","1.121 (0.04)","1.122 (0.043)","0.26 (0.078)","0.321 (0.03)","0.321 (0.029)","0.257 (0.101)","0.339 (0.042)","0.34 (0.042)","0.286 (0.109)","0.319 (0.031)","0.319 (0.031)","0.518 (0.239)","0.304 (0.029)","0.303 (0.029)","0.783 (0.223)","0.295 (0.027)","0.295 (0.027)","3.127 (0.378)","3.138 (0.384)","3.141 (0.382)","1.727 (0.033)","1.651 (0.047)","1.654 (0.043)","0.597 (0.166)","0.668 (0.036)","0.668 (0.036)","0.498 (0.166)","0.719 (0.05)","0.72 (0.051)","0.63 (0.23)","0.67 (0.041)","0.671 (0.041)","2.486 (1.153)","2.425 (1.25)","2.427 (1.248)","0.97 (0.248)","0.654 (0.036)","0.654 (0.035)"],["0.562 (0.014)","0.561 (0.016)","0.561 (0.015)","1.4 (0.01)","1.261 (0.016)","1.261 (0.018)","0.998 (0.025)","0.996 (0.026)","0.997 (0.026)","0.997 (0.027)","0.996 (0.027)","0.997 (0.028)","0.999 (0.026)","0.998 (0.027)","0.999 (0.027)","0.959 (0.107)","0.957 (0.107)","0.957 (0.106)","1.038 (0.025)","1.036 (0.025)","1.035 (0.025)","0.134 (0.014)","0.133 (0.014)","0.133 (0.014)","1.221 (0.01)","0.865 (0.018)","0.865 (0.019)","0.985 (0.024)","0.984 (0.024)","0.984 (0.025)","0.981 (0.031)","0.979 (0.032)","0.98 (0.033)","0.985 (0.025)","0.984 (0.026)","0.984 (0.026)","1.068 (0.079)","0.969 (0.026)","0.969 (0.026)","1.202 (0.081)","0.997 (0.025)","0.996 (0.025)","0.032 (0.008)","0.032 (0.008)","0.032 (0.008)","1.015 (0.008)","0.411 (0.014)","0.412 (0.014)","0.958 (0.048)","0.802 (0.019)","0.803 (0.02)","0.841 (0.064)","0.763 (0.033)","0.763 (0.032)","0.963 (0.059)","0.8 (0.018)","0.8 (0.019)","1.116 (0.061)","0.812 (0.017)","0.813 (0.018)","1.207 (0.035)","0.806 (0.018)","0.807 (0.018)","0.018 (0.006)","0.017 (0.006)","0.017 (0.006)","0.949 (0.007)","0.262 (0.01)","0.263 (0.01)","0.967 (0.064)","0.615 (0.015)","0.616 (0.015)","0.744 (0.096)","0.574 (0.03)","0.574 (0.029)","0.969 (0.084)","0.613 (0.016)","0.614 (0.015)","0.927 (0.318)","0.555 (0.184)","0.555 (0.184)","1.099 (0.065)","0.613 (0.016)","0.614 (0.016)","0.614 (0.016)","0.613 (0.018)","0.613 (0.019)","1.335 (0.021)","1.146 (0.024)","1.148 (0.027)","1.013 (0.027)","1.011 (0.028)","1.011 (0.028)","1.011 (0.03)","1.009 (0.03)","1.01 (0.03)","1.013 (0.029)","1.011 (0.029)","1.012 (0.029)","0.875 (0.191)","0.873 (0.191)","0.874 (0.191)","1.035 (0.028)","1.03 (0.028)","1.032 (0.03)","0.144 (0.015)","0.144 (0.015)","0.144 (0.015)","1.303 (0.017)","0.893 (0.021)","0.895 (0.02)","0.998 (0.027)","0.995 (0.028)","0.996 (0.027)","0.997 (0.029)","0.994 (0.029)","0.996 (0.03)","0.999 (0.027)","0.995 (0.027)","0.997 (0.028)","1.051 (0.105)","0.992 (0.028)","0.993 (0.027)","1.211 (0.128)","1.004 (0.025)","1.006 (0.025)","0.035 (0.009)","0.034 (0.009)","0.034 (0.009)","1.125 (0.013)","0.458 (0.015)","0.459 (0.014)","1.069 (0.074)","0.856 (0.022)","0.857 (0.021)","0.832 (0.069)","0.784 (0.041)","0.785 (0.041)","1.072 (0.1)","0.854 (0.025)","0.855 (0.024)","1.234 (0.085)","0.874 (0.021)","0.875 (0.02)","1.349 (0.031)","0.882 (0.019)","0.883 (0.019)","0.019 (0.006)","0.019 (0.006)","0.019 (0.006)","1.056 (0.012)","0.296 (0.012)","0.296 (0.011)","1.221 (0.081)","0.712 (0.021)","0.713 (0.021)","0.715 (0.113)","0.597 (0.047)","0.597 (0.047)","1.208 (0.088)","0.709 (0.021)","0.71 (0.021)","1.098 (0.426)","0.624 (0.239)","0.624 (0.24)","1.292 (0.026)","0.719 (0.019)","0.72 (0.019)","0.154 (0.015)","0.154 (0.015)","0.154 (0.015)","1.451 (0.014)","0.916 (0.023)","0.916 (0.023)","0.932 (0.024)","0.918 (0.025)","0.918 (0.025)","0.826 (0.096)","0.807 (0.095)","0.808 (0.095)","0.933 (0.035)","0.917 (0.033)","0.917 (0.033)","1.147 (0.259)","0.897 (0.11)","0.898 (0.11)","1.349 (0.214)","1.017 (0.023)","1.017 (0.022)","0.08 (0.01)","0.08 (0.01)","0.08 (0.009)","1.435 (0.011)","0.697 (0.021)","0.699 (0.02)","0.931 (0.03)","0.907 (0.028)","0.907 (0.028)","0.811 (0.103)","0.766 (0.095)","0.767 (0.095)","0.933 (0.037)","0.902 (0.031)","0.903 (0.031)","1.225 (0.236)","0.912 (0.04)","0.913 (0.041)","1.46 (0.113)","0.957 (0.026)","0.959 (0.027)","0.03 (0.005)","0.03 (0.005)","0.03 (0.005)","1.322 (0.01)","0.383 (0.011)","0.383 (0.011)","0.962 (0.072)","0.692 (0.023)","0.693 (0.022)","0.74 (0.126)","0.633 (0.056)","0.633 (0.056)","1.005 (0.121)","0.693 (0.023)","0.693 (0.024)","1.453 (0.106)","0.702 (0.022)","0.703 (0.023)","1.395 (0.111)","0.707 (0.022)","0.708 (0.022)","0.018 (0.004)","0.018 (0.004)","0.018 (0.004)","1.282 (0.01)","0.274 (0.008)","0.274 (0.008)","1.002 (0.113)","0.532 (0.02)","0.532 (0.02)","0.587 (0.129)","0.457 (0.045)","0.458 (0.045)","1.035 (0.151)","0.531 (0.02)","0.531 (0.02)","0.973 (0.623)","0.384 (0.239)","0.384 (0.239)","1.327 (0.115)","0.538 (0.02)","0.539 (0.019)","0.339 (0.011)","0.339 (0.012)","0.339 (0.012)","1.352 (0.012)","1.145 (0.017)","1.145 (0.018)","0.96 (0.021)","0.954 (0.022)","0.954 (0.021)","0.96 (0.025)","0.954 (0.024)","0.954 (0.024)","0.961 (0.022)","0.955 (0.022)","0.955 (0.022)","0.95 (0.029)","0.944 (0.026)","0.944 (0.027)","1.065 (0.026)","1.033 (0.019)","1.033 (0.018)","0.095 (0.01)","0.095 (0.01)","0.095 (0.01)","1.162 (0.011)","0.732 (0.017)","0.732 (0.018)","0.952 (0.022)","0.931 (0.021)","0.931 (0.021)","0.951 (0.03)","0.929 (0.026)","0.928 (0.026)","0.956 (0.025)","0.933 (0.021)","0.932 (0.021)","1.021 (0.091)","0.93 (0.032)","0.929 (0.03)","1.284 (0.027)","0.963 (0.02)","0.963 (0.02)","0.025 (0.005)","0.025 (0.005)","0.025 (0.005)","0.98 (0.008)","0.328 (0.011)","0.328 (0.012)","0.937 (0.062)","0.671 (0.018)","0.672 (0.018)","0.888 (0.092)","0.664 (0.022)","0.664 (0.023)","0.951 (0.069)","0.671 (0.018)","0.672 (0.018)","1.052 (0.074)","0.672 (0.018)","0.673 (0.018)","1.128 (0.053)","0.67 (0.018)","0.67 (0.019)","0.014 (0.003)","0.014 (0.003)","0.014 (0.003)","0.933 (0.007)","0.214 (0.008)","0.214 (0.007)","0.877 (0.078)","0.491 (0.015)","0.491 (0.015)","0.752 (0.112)","0.475 (0.017)","0.476 (0.018)","0.883 (0.103)","0.489 (0.016)","0.49 (0.016)","0.313 (0.456)","0.162 (0.227)","0.162 (0.226)","1.015 (0.078)","0.49 (0.016)","0.49 (0.016)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Scenario<\/th>\n      <th>Sample<\/th>\n      <th>Selected Tree<\/th>\n      <th>mse<\/th>\n      <th>AUC<\/th>\n      <th>brier<\/th>\n      <th>ICI<\/th>\n      <th>KL Div.<\/th>\n      <th>Quant. Ratio<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"rowGroup":{"dataSrc":0},"iDisplayLength":21,"columnDefs":[{"name":"scenario","targets":0},{"name":"sample","targets":1},{"name":"result_type","targets":2},{"name":"mse","targets":3},{"name":"AUC","targets":4},{"name":"brier","targets":5},{"name":"ici","targets":6},{"name":"KL_20_true_probas","targets":7},{"name":"inter_quantile_10_90","targets":8}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\nvar value=data[1]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\nvar value=data[2]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\nvar value=data[3]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\nvar value=data[4]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\nvar value=data[5]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\nvar value=data[6]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\nvar value=data[7]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\nvar value=data[8]; $(row).css({'color':'white','background-color':value == \"Smallest\" ? \"#332288\" : value == \"Largest\" ? \"#117733\" : value == \"AUC*\" ? \"#AA4499\" : value == \"MSE*\" ? \"#882255\" : value == \"Brier*\" ? \"#DDCC77\" : value == \"ICI*\" ? \"#44AA99\" : value == \"KL*\" ? \"#949698\" : null});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="figures" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="figures"><span class="header-section-number">6.5.2</span> Figures</h3>
<section id="scores-distributions" class="level4" data-number="6.5.2.1">
<h4 data-number="6.5.2.1" class="anchored" data-anchor-id="scores-distributions"><span class="header-section-number">6.5.2.1</span> Scores Distributions</h4>
<p>Let us plot the distributions of scores for the trees of interest (smallest, largest, max AUC, min MSE, min KL) for a single replication (the first replication) for each scenario.</p>
<div class="cell">
<details class="code-fold">
<summary>Codes to get the barplots</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>get_bp <span class="ot">&lt;-</span> <span class="cf">function</span>(interest,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                   scenario,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                   repn) {</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify the row number of the grid</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  rf_of_interest_plot <span class="ot">&lt;-</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    rf_of_interest <span class="sc">|&gt;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>      result_type <span class="sc">==</span> <span class="sc">!!</span>interest,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">==</span> <span class="sc">!!</span>scenario,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>      repn <span class="sc">==</span> <span class="sc">!!</span>repn,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>      sample <span class="sc">==</span> <span class="st">"Test"</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  ind_grid <span class="ot">&lt;-</span> rf_of_interest_plot <span class="sc">|&gt;</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="st">"ind"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The corresponding barplots data</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  data_bp <span class="ot">&lt;-</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(resul_rf[[scenario]], <span class="st">"scores_hist"</span>)[[repn]] <span class="sc">|&gt;</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pluck</span>(ind_grid)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  subtitle <span class="ot">&lt;-</span> <span class="fu">str_c</span>(</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No. Leaves = "</span>, rf_of_interest_plot<span class="sc">$</span>nb_leaves, <span class="st">", "</span>,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"AUC = "</span>, <span class="fu">round</span>(rf_of_interest_plot<span class="sc">$</span>AUC, <span class="dv">2</span>), <span class="st">", </span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Brier = "</span>, <span class="fu">round</span>(rf_of_interest_plot<span class="sc">$</span>brier, <span class="dv">2</span>), <span class="st">", "</span>,</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ICI = "</span>, <span class="fu">round</span>(rf_of_interest_plot<span class="sc">$</span>ici, <span class="dv">2</span>), <span class="st">", "</span>,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"KL = "</span>, <span class="fu">round</span>(rf_of_interest_plot<span class="sc">$</span>KL_20_true_probas, <span class="dv">2</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> interest,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    data_bp<span class="sc">$</span>test,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">hat{s}(x)$"</span>),</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">""</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">adj =</span> .<span class="dv">5</span>, subtitle, <span class="at">cex =</span> .<span class="dv">6</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>plot_hist_scenario <span class="ot">&lt;-</span> <span class="cf">function</span>(scenario,</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>                               repn) {</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># True probabilities</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  simu_data <span class="ot">&lt;-</span> <span class="fu">simulate_data_wrapper</span>(</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">scenario =</span> scenario,</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">params_df =</span> params_df,</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">repn =</span> repn <span class="co"># only one replication here</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>  true_prob <span class="ot">&lt;-</span> simu_data<span class="sc">$</span>data<span class="sc">$</span>probs_train</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    true_prob,</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">05</span>),</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"True Probabilities"</span>,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (interest <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Smallest"</span>, <span class="st">"Largest"</span>, <span class="st">"MSE*"</span> ,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"AUC*"</span>, <span class="st">"Brier*"</span>, <span class="st">"ICI*"</span>, <span class="st">"KL*"</span>)) {</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_bp</span>(</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">interest =</span> interest,</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">scenario =</span> scenario,</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">repn =</span> repn</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Showing plots for the first replication only:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>repn <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" aria-current="page">DGP 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">DGP 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">DGP 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">DGP 4</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 1, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 1, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 1, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 1, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 2, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 2, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 2, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 2, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 3, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 3, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 3, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 3, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 4, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 4, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 4, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Distribution of true probabilities and estimated scores on test set for random forests of interest (DGP 4, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="metrics-vs-number-of-leaves" class="level4" data-number="6.5.2.2">
<h4 data-number="6.5.2.2" class="anchored" data-anchor-id="metrics-vs-number-of-leaves"><span class="header-section-number">6.5.2.2</span> Metrics vs Number of Leaves</h4>
<p>We can also plot some metrics as a function of the average number of leaves in the trees of the forests.</p>
<!-- ```{r define-plot_metric_leaves} -->
<!-- #| code-fold: true -->
<!-- #| code-summary: Codes to get the plots -->
<!-- plot_metric_leaves <- function(metrics = c("ici", "KL_20_true_probas"), -->
<!--                                scenario_number) { -->
<!--   data_plot <-  -->
<!--     metrics_rf_all |>  -->
<!--     filter(scenario == scenario_number) |>  -->
<!--     left_join(grid |> select(ind, mtry, min_node_size, num_trees), by = "ind") |>  -->
<!--     group_by( -->
<!--       sample, scenario, ind, mtry -->
<!--     ) |>  -->
<!--     summarise( -->
<!--       KL_20_true_probas = mean(KL_20_true_probas), -->
<!--       auc = mean(AUC), -->
<!--       brier = mean(brier), -->
<!--       ici = mean(ici), -->
<!--       nb_leaves = mean(nb_leaves), -->
<!--       .groups = "drop" -->
<!--     ) |>  -->
<!--     mutate( -->
<!--       mtry_lab = factor(mtry), -->
<!--       mtry_lab = fct_reorder(mtry_lab, mtry), -->
<!--       scenario = str_c("Scenario ", scenario) -->
<!--     ) |>  -->
<!--     pivot_longer(cols = c(auc, brier, ici, KL_20_true_probas), names_to = "metric") |>  -->
<!--     mutate(metric = factor( -->
<!--       metric,  -->
<!--       levels = c("auc", "brier", "ici", "KL_20_true_probas"),  -->
<!--       labels = c("AUC", "Brier", "ICI", "KL Divergence") -->
<!--     )) -->
<!--   ggplot( -->
<!--     data = data_plot |> group_by(mtry_lab) |> arrange(nb_leaves), -->
<!--     mapping = aes(x = nb_leaves, y = value) -->
<!--   ) + -->
<!--     geom_line( -->
<!--       mapping = aes(colour = sample, linetype = mtry_lab, group = ) -->
<!--     ) + -->
<!--     ggh4x::facet_grid2(~metric, scales = "free_y", independent = "y") + -->
<!--     scale_colour_manual("Sample", values = colour_samples) + -->
<!--     scale_linetype_discrete("Mtry") + -->
<!--     theme_paper() + -->
<!--     labs(x = "Average Number of leaves", y = NULL) -->
<!-- } -->
<!-- ``` -->
<!-- :::{.panel-tabset} -->
<!-- ```{r tb-metric-vs-leaves-reg, echo = FALSE} -->
<!-- tb_labs <- expand_grid( -->
<!--   scenario = 1:16,  -->
<!-- ) |>  -->
<!--   mutate( -->
<!--     dgp = case_when( -->
<!--       scenario %in% 1:4 ~ 1, -->
<!--       scenario %in% 5:8 ~ 2, -->
<!--       scenario %in% 9:12 ~ 3, -->
<!--       scenario %in% 13:16 ~ 4 -->
<!--     ), -->
<!--     no_noise = c(0, 10, 50, 100)[(scenario-1)%%4 + 1] -->
<!--   ) |>  -->
<!--   mutate( -->
<!--     label = str_c("Metrics depending on the average number of leaves in the estimated trees of the forests (DGP ", dgp, ", ", no_noise, " noise variables)") -->
<!--   ) |>  -->
<!--   mutate(i_row = row_number()) -->
<!-- plot_metrics_config <- function(i_values) { -->
<!--   res <- purrr::map_chr(i_values, \(i) { -->
<!--     knitr::knit_child( -->
<!--       input = "children-dir/forests-metric-vs-leaves-reg.qmd",  -->
<!--       envir = environment(),  -->
<!--       quiet = TRUE -->
<!--       ) -->
<!--   }) -->
<!-- cat(res, sep = '\n') -->
<!-- } -->
<!-- ``` -->
<!-- ##### DGP 1 -->
<!-- ::::{.panel-tabset} -->
<!-- ```{r plots-metric-vs-leaves-reg-1} -->
<!-- #| output: asis -->
<!-- #| echo: false -->
<!-- i_values <- tb_labs |> filter(scenario %in% 1:4) |> pull("i_row") -->
<!-- plot_metrics_config(i_values) -->
<!-- ``` -->
<!-- :::: -->
<!-- ##### DGP 2 -->
<!-- ::::{.panel-tabset} -->
<!-- ```{r plots-metric-vs-leaves-reg-2} -->
<!-- #| output: asis -->
<!-- #| echo: false -->
<!-- i_values <- tb_labs |> filter(scenario %in% 5:8) |> pull("i_row") -->
<!-- plot_metrics_config(i_values) -->
<!-- ``` -->
<!-- :::: -->
<!-- ##### DGP 3 -->
<!-- ::::{.panel-tabset} -->
<!-- ```{r plots-metric-vs-leaves-reg-3} -->
<!-- #| output: asis -->
<!-- #| echo: false -->
<!-- i_values <- tb_labs |> filter(scenario %in% 9:12) |> pull("i_row") -->
<!-- plot_metrics_config(i_values) -->
<!-- ``` -->
<!-- :::: -->
<!-- ##### DGP 4 -->
<!-- ::::{.panel-tabset} -->
<!-- ```{r plots-metric-vs-leaves-reg-4} -->
<!-- #| output: asis -->
<!-- #| echo: false -->
<!-- i_values <- tb_labs |> filter(scenario %in% 13:16) |> pull("i_row") -->
<!-- plot_metrics_config(i_values) -->
<!-- ``` -->
<!-- :::: -->
<!-- ::: -->
<div class="cell">
<details class="code-fold">
<summary>Codes to get the plots</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plot_metric_leaves <span class="ot">&lt;-</span> <span class="cf">function</span>(dgp) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  data_plot <span class="ot">&lt;-</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">dgp =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        scenario <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        scenario <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        scenario <span class="sc">%in%</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">12</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        scenario <span class="sc">%in%</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">no_noise =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>)[(scenario<span class="dv">-1</span>)<span class="sc">%%</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>],</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">no_noise =</span> <span class="fu">factor</span>(no_noise, <span class="at">levels =</span> <span class="fu">c</span>(no_noise), <span class="at">labels =</span> <span class="fu">str_c</span>(no_noise, <span class="st">" noise variables"</span>))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dgp <span class="sc">==</span> <span class="sc">!!</span>dgp) <span class="sc">|&gt;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(grid <span class="sc">|&gt;</span> <span class="fu">select</span>(ind, mtry, min_node_size, num_trees), <span class="at">by =</span> <span class="st">"ind"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>      sample, dgp, no_noise, scenario, ind, mtry</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">KL_20_true_probas =</span> <span class="fu">mean</span>(KL_20_true_probas),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">auc =</span> <span class="fu">mean</span>(AUC),</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">brier =</span> <span class="fu">mean</span>(brier),</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">ici =</span> <span class="fu">mean</span>(ici),</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">nb_leaves =</span> <span class="fu">mean</span>(nb_leaves),</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">mtry_lab =</span> <span class="fu">factor</span>(mtry),</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">mtry_lab =</span> <span class="fu">fct_reorder</span>(mtry_lab, mtry),</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(auc, brier, ici, KL_20_true_probas), <span class="at">names_to =</span> <span class="st">"metric"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">metric =</span> <span class="fu">factor</span>(</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>      metric,</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"auc"</span>, <span class="st">"brier"</span>, <span class="st">"ici"</span>, <span class="st">"KL_20_true_probas"</span>),</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"AUC"</span>, <span class="st">"Brier"</span>, <span class="st">"ICI"</span>, <span class="st">"KL Divergence"</span>)</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_plot <span class="sc">|&gt;</span> <span class="fu">group_by</span>(mtry_lab) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(nb_leaves),</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> nb_leaves, <span class="at">y =</span> value)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">colour =</span> sample, <span class="at">linetype =</span> mtry_lab, <span class="at">group =</span> )</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    ggh4x<span class="sc">::</span><span class="fu">facet_grid2</span>(metric<span class="sc">~</span>no_noise, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">independent =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Sample"</span>, <span class="at">values =</span> colour_samples) <span class="sc">+</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_discrete</span>(<span class="st">"Mtry"</span>) <span class="sc">+</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_paper</span>() <span class="sc">+</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Average Number of leaves"</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">DGP 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">DGP 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">DGP 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">DGP 4</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell" data-fig-label="rf-metrics-leaves-dgp-1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_metric_leaves</span>(<span class="at">dgp =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Metrics depending on the average number of leaves in the estimated trees of the forests (DGP 1)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell" data-fig-label="rf-metrics-leaves-dgp-2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_metric_leaves</span>(<span class="at">dgp =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Metrics depending on the average number of leaves in the estimated trees of the forests (DGP 2)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell" data-fig-label="rf-metrics-leaves-dgp-3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_metric_leaves</span>(<span class="at">dgp =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Metrics depending on the average number of leaves in the estimated trees of the forests (DGP 3)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell" data-fig-label="rf-metrics-leaves-dgp-4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_metric_leaves</span>(<span class="at">dgp =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Metrics depending on the average number of leaves in the estimated trees of the forests (DGP 4)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="relationship-between-calibration-kl-divergence-and-tree-complexity" class="level4" data-number="6.5.2.3">
<h4 data-number="6.5.2.3" class="anchored" data-anchor-id="relationship-between-calibration-kl-divergence-and-tree-complexity"><span class="header-section-number">6.5.2.3</span> Relationship between calibration, KL divergence and tree complexity</h4>
<p>For a given scenario, each dot in the figures below is obtained by computing the average metrics on the 100 replications.</p>
<div class="cell">
<details class="code-fold">
<summary>Codes to get the plots</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>plot_kl_vs_calib <span class="ot">&lt;-</span> <span class="cf">function</span>(scenario_number,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                             calib_metric,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">log_scale =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  data_plot <span class="ot">&lt;-</span> metrics_rf_all <span class="sc">|&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(grid <span class="sc">|&gt;</span> <span class="fu">select</span>(ind, mtry)) <span class="sc">|&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scenario <span class="sc">==</span> <span class="sc">!!</span>scenario_number) <span class="sc">|&gt;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>      sample, scenario, ind, mtry</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">KL_20_true_probas =</span> <span class="fu">mean</span>(KL_20_true_probas),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ici =</span> <span class="fu">mean</span>(ici),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">brier =</span> <span class="fu">mean</span>(brier),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">nb_leaves =</span> <span class="fu">mean</span>(nb_leaves),</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">auc =</span> <span class="fu">mean</span>(AUC),</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">mtry_lab =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">"mtry = "</span>, mtry)),</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">mtry_lab =</span> <span class="fu">fct_reorder</span>(mtry_lab, mtry)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  data_plot_max_auc <span class="ot">&lt;-</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    data_plot <span class="sc">|&gt;</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Test"</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sample, scenario) <span class="sc">|&gt;</span> <span class="co"># not by mtry here</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is_max_auc =</span> auc <span class="sc">==</span> <span class="fu">max</span>(auc)) <span class="sc">|&gt;</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is_max_auc <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(sample, scenario, <span class="sc">!!</span>calib_metric, KL_20_true_probas)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  x_lab <span class="ot">&lt;-</span> <span class="fu">str_c</span>(</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Calibration ("</span>, <span class="fu">ifelse</span>(calib_metric <span class="sc">==</span> <span class="st">"ici"</span>, <span class="st">"ICI"</span>, <span class="st">"Brier Score"</span>),</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(log_scale <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="st">", log scale)"</span>, <span class="st">")"</span>)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_plot <span class="sc">|&gt;</span> <span class="fu">group_by</span>(mtry) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(nb_leaves),</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(calib_metric), <span class="at">y =</span> KL_20_true_probas</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_point(alpha = .5, mapping = aes(size = nb_leaves, colour = sample)) +</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">colour =</span> sample),</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">ends =</span> <span class="st">"last"</span>,</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.08</span>, <span class="st">"inches"</span>))</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data_plot_max_auc,</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="sc">!!</span><span class="fu">sym</span>(calib_metric)),</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data_plot_max_auc,</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">yintercept =</span> KL_20_true_probas),</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>mtry_lab) <span class="sc">+</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">"Sample"</span>, <span class="at">values =</span> colour_samples) <span class="sc">+</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_lab, <span class="at">y =</span> <span class="st">"KL Divergence"</span>) <span class="sc">+</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_binned_area</span>(<span class="st">"Number of Leaves"</span>) <span class="sc">+</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_paper</span>() <span class="sc">+</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>))</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (log_scale) p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>  p</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The dashed lines correspond to the values of the KL divergence and the calibration of the forest at which the AUC is the highest among the models of the grid search.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">ICI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">ICI, log scale</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-3" role="tab" aria-controls="tabset-27-3" aria-selected="false">Brier</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-4" role="tab" aria-controls="tabset-27-4" aria-selected="false">Brier, log scale</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">DGP 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">DGP 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">DGP 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">DGP 4</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">DGP 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">DGP 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">DGP 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false">DGP 4</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 0 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 10 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-136-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 50 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-138-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 100 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-140-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 0 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-143-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 10 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-145-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 50 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-147-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 100 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-149-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 0 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-152-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 10 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-154-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 50 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-156-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 100 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-158-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 0 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-161-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 10 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-163-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 50 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-165-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 100 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-167-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-27-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-3-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">DGP 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">DGP 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">DGP 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-4" role="tab" aria-controls="tabset-21-4" aria-selected="false">DGP 4</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-170-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-172-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-174-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-176-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-4" role="tab" aria-controls="tabset-18-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-179-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-181-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-183-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-185-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-4" role="tab" aria-controls="tabset-19-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-188-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-190-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-192-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-194-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-21-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-4-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-4" role="tab" aria-controls="tabset-20-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 0 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-197-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 10 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-199-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 50 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-201-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 100 noise variables)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-203-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-27-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-4-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">DGP 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">DGP 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false">DGP 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-4" role="tab" aria-controls="tabset-26-4" aria-selected="false">DGP 4</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-4" role="tab" aria-controls="tabset-22-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 0 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-206-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 10 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-208-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 50 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-210-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-22-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 1, 100 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-212-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 0 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-215-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 10 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-217-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 50 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-219-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 2, 100 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-221-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-4" role="tab" aria-controls="tabset-24-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 0 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-224-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 10 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-226-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 50 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-228-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 3, 100 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-230-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-26-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-4-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false">50</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-4" role="tab" aria-controls="tabset-25-4" aria-selected="false">100</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 0 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-233-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 10 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-235-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 50 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-237-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-25-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Complexity of a tree and relationship with calibration and divergence of scores to the true probabilities. (DGP 4, 100 noise variables, log scale)</figcaption>
<p><img src="book_ojeda_forests_files/figure-html/unnamed-chunk-239-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>We can also put all the scenarios in a single graph.</p>
<div class="cell">
<details class="code-fold">
<summary>Codes to prepare the figure</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data_plot <span class="ot">&lt;-</span> metrics_rf_all <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(grid <span class="sc">|&gt;</span> <span class="fu">select</span>(ind, mtry), <span class="at">by =</span> <span class="st">"ind"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    sample, scenario, ind, mtry</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">KL_20_true_probas =</span> <span class="fu">mean</span>(KL_20_true_probas),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ici =</span> <span class="fu">mean</span>(ici),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">brier =</span> <span class="fu">mean</span>(brier),</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_leaves =</span> <span class="fu">mean</span>(nb_leaves),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">auc =</span> <span class="fu">mean</span>(AUC),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry_lab =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">"mtry = "</span>, mtry)),</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry_lab =</span> <span class="fu">fct_reorder</span>(mtry_lab, mtry)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">dgp =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">12</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>      scenario <span class="sc">%in%</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">dgp =</span> <span class="fu">factor</span>(dgp, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"DGP "</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">no_noise =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>)[(scenario<span class="dv">-1</span>)<span class="sc">%%</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>],</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">no_noise =</span> <span class="fu">factor</span>(</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        no_noise, <span class="at">levels =</span> <span class="fu">c</span>(no_noise),</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">str_c</span>(no_noise, <span class="st">" noise variables"</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>data_plot_max_auc <span class="ot">&lt;-</span> </span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  data_plot <span class="sc">|&gt;</span> </span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"Test"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample, scenario) <span class="sc">|&gt;</span> <span class="co"># not by mtry here</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_max_auc =</span> auc <span class="sc">==</span> <span class="fu">max</span>(auc)) <span class="sc">|&gt;</span> </span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_max_auc <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample, dgp, no_noise, scenario, brier, ici, KL_20_true_probas)</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>formatter1000 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">*</span><span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">ICI</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">Brier</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Codes to create the figure</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>p_ici <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_plot <span class="sc">|&gt;</span> <span class="fu">group_by</span>(mtry) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(nb_leaves),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ici, <span class="at">y =</span> KL_20_true_probas</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">colour =</span> sample, <span class="at">linetype =</span> mtry_lab),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">ends =</span> <span class="st">"last"</span>, </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.08</span>, <span class="st">"inches"</span>))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_plot_max_auc,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> ici),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_plot_max_auc,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">yintercept =</span> KL_20_true_probas),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(~mtry_lab) +</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggh4x::facet_wrap2(~scenario, scales = "free_y") +</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_grid2</span>(dgp<span class="sc">~</span>no_noise, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">independent =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">"Sample"</span>, <span class="at">values =</span> colour_samples) <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Mtry"</span>) <span class="sc">+</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_paper</span>() <span class="sc">+</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"Calibration (ICI), $</span><span class="sc">\\</span><span class="st">times 10^{3}$, log scale"</span>), </span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"KL Divergence"</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> formatter1000) <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(p_ici, <span class="at">file =</span> <span class="st">"figures/rf-kl-calib-ici-leaves-all.pdf"</span>,</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>p_ici</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-kl-calib-rf-iterations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-kl-calib-rf-iterations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: KL Divergence and Calibration (ICI) across increasing average number of leaves in the trees (log scales)
</figcaption>
<div aria-describedby="fig-kl-calib-rf-iterations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="book_ojeda_forests_files/figure-html/fig-kl-calib-rf-iterations-1.png" class="img-fluid figure-img" width="960">
</div>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Codes to create the figure</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>p_brier <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_plot <span class="sc">|&gt;</span> <span class="fu">group_by</span>(mtry) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(nb_leaves),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> brier, <span class="at">y =</span> KL_20_true_probas</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">colour =</span> sample, <span class="at">linetype =</span> mtry_lab),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">ends =</span> <span class="st">"last"</span>, </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.08</span>, <span class="st">"inches"</span>))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_plot_max_auc,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> brier),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_plot_max_auc,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">yintercept =</span> KL_20_true_probas),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_grid2</span>(dgp<span class="sc">~</span>no_noise, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">independent =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(dgp~no_noise) +</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">"Sample"</span>, <span class="at">values =</span> colour_samples) <span class="sc">+</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Mtry"</span>) <span class="sc">+</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_paper</span>() <span class="sc">+</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"Calibration (ICI), $</span><span class="sc">\\</span><span class="st">times 10^{3}$, log scale"</span>), </span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"KL Divergence"</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> formatter1000) <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(p_brier, <span class="at">file =</span> <span class="st">"figures/rf-kl-calib-brier-leaves-all.pdf"</span>,</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>p_brier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-kl-calib-brier-rf-iterations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-kl-calib-brier-rf-iterations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: KL Divergence and Calibration (ICI) across increasing average number of leaves in the trees (log scales)
</figcaption>
<div aria-describedby="fig-kl-calib-brier-rf-iterations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="book_ojeda_forests_files/figure-html/fig-kl-calib-brier-rf-iterations-1.png" class="img-fluid figure-img" width="960">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Ojeda_2023" class="csl-entry" role="listitem">
Ojeda, Francisco M., Max L. Jansen, Alexandre Thiéry, Stefan Blankenberg, Christian Weimar, Matthias Schmid, and Andreas Ziegler. 2023. <span>“Calibrating Machine Learning Approaches for Probability Estimation: A Comprehensive Comparison.”</span> <em>Statistics in Medicine</em> 42 (29): 5451–78. <a href="https://doi.org/10.1002/sim.9921">https://doi.org/10.1002/sim.9921</a>.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./book_ojeda_trees.html" class="pagination-link" aria-label="Decision Trees">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Decision Trees</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./book_ojeda_forests_ntrees.html" class="pagination-link" aria-label="Random Forests: number of trees">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Random Forests: number of trees</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
    <script type="text/javascript">
    (function(d) {
      d.querySelectorAll(".pseudocode-container").forEach(function(el) {
        let pseudocodeOptions = {
          indentSize: el.dataset.indentSize || "1.2em",
          commentDelimiter: el.dataset.commentDelimiter || "//",
          lineNumber: el.dataset.lineNumber === "true" ? true : false,
          lineNumberPunc: el.dataset.lineNumberPunc || ":",
          noEnd: el.dataset.noEnd === "true" ? true : false,
          titlePrefix: el.dataset.algTitle || "Algorithm"
        };
        pseudocode.renderElement(el.querySelector(".pseudocode"), pseudocodeOptions);
      });
    })(document);
    (function(d) {
      d.querySelectorAll(".pseudocode-container").forEach(function(el) {
        titleSpan = el.querySelector(".ps-root > .ps-algorithm > .ps-line > .ps-keyword")
        titlePrefix = el.dataset.algTitle;
        titleIndex = el.dataset.chapterLevel ? el.dataset.chapterLevel + "." + el.dataset.pseudocodeIndex : el.dataset.pseudocodeIndex;
        titleSpan.innerHTML = titlePrefix + " " + titleIndex + " ";
      });
    })(document);
    </script>
  




</body></html>